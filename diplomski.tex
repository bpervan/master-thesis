\documentclass[times, utf8, diplomski, numeric]{fer}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{verbatim}
\usepackage{tikz,times}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{color}
\usepackage{wrapfig}
\usepackage{rotating}

\definecolor{mygray}{rgb}{0.5,0.5,0.5}

\newcommand{\setalglineno}[1]{%
  \setcounter{ALC@line}{\numexpr#1-1}}
\makeatother

\begin{document}
\thesisnumber{1136}
\title{Preporučiteljski sustavi u sveprisutnom računarstvu}
\author{Branimir Pervan}
\maketitle

\izvornik

\zahvala{Ovdje dolazi zahvala}

\tableofcontents

\chapter{Uvod}
U posljednjih dvadesetak godina razvoj Interneta stvari \engl{Internet
of Things} uhvatio je gotovo eksponencijalni zamah, a pojedini izvori navode da
će broj uređaja priključenih na ovu sveprisutnu mrežu do $2020$. g. doseći $26$
milijardi \cite{gartner2013Iot} odnosno $30$ milijardi \cite{ABI2013Iot}. Tomu
značajno doprinosi i konstantno opadanje cijene proizvodnog procesa tehnologije
koja naizgled obične stvari na neki način čini inteligentnima i sposobnima za
komunikaciju. Internet stvari samo je jedna od mogućih manifestacija
sveprisutnog računarstva.Sveprisutno računarstvo, kao koncept u računarskoj
znanosti gdje je računarstvo prisutno svugdje \cite{theComputerWeiser}, opisuje
upravo takve vrste stvari i uređaja, ali i takve principe gdje računalo može
biti ugrađeno u bilo kojem uređaju, na bilo kojoj lokaciji i u bilo kojem
obliku. Čovječanstvo je danas nepobitno zagazilo u treće računarsko doba koje
nakon doba osobnih računala predviđa prožimanje računala u svakodnevnicu. To
nedvojbeno znači da će se broj računala povećati, a time će se povećati i
količina podataka koja će biti prikupljena ili generirana od strane takvih
računala. Također, zbog činjenice sveprisutnosti, kontekst, a pogotovo prostor i
vrijeme, u kojem se računalo nalazi postaje važna karakteristika za opisivanje i
korištenje sustava.

S druge strane, preporučiteljski sustavi su se kroz posljednjih tridesetak
godina nametnuli kao standard u filtriranju sadržaja u onim sustavima i uslugama
koje imaju značajan udio dodira s krajnjim korisnicima. Moderne usluge i sustavi
sa sadržajem gotovo su nezamislivi bez preporučitelja zbog količine informacija,
u smislu predmeta preporuke, koja postoji u takvim sustavima. Primjer se može
naći u modernijim internetskim dućanima u kojima korisnik obično ne može znati
koji su sve predmeti dostupni i koji su sve predmeti povezani s onim predmetima
koji su njemu od interesa. S druge strane, sustavi multimedije na zahtjev
\engl{multimedia-on-demand} općenito sadrže velike količine multimedije za koju
korisnik ne zna da postoji. Nerijetko se zbog toga zna dogoditi da korisnik
eksplicitno traži od sustava preporuku za glazbu ili film koji bi mu se mogao
svidjeti.

S obzirom na činjenicu da će sveprisutno računarstvo nastaviti razvoj u
započetom smijeru, prirodno se nameće potreba za preporučiteljskim sustavima u
takvoj vrsti računarstva. Usluge koje sveprisutno računarstvo već sada nudi ili
će tek nuditi neophodno će zahtjevati filtriranje informacija. Preporuke koje će
takvi sustavi davati morat će biti svjesne konteksta, a pogotovo prostora i
vremena u kojem se nalaze. Potreba i smisao izučavanja sinteze ova dva područja
dolazi iz očitog primjera za ulaganjem u bolje i efikasnije algoritme jer je u
nepreglednoj masi informacija, kakav je Internet stvari i sveprisutno
računarstvo idealan izvor, procesna moć današnjih računala davno izgubila
bitku.

Motiv ovog diplomskog rada jest manjak dostupnih algoritama i radnih okvira
specifičnih za preporučiteljske sustave u sveprisutnom računarstvu. U ovom radu
dat će se kratak uvod u sveprisutno računarstvo, teorijska podloga bazičnih
algoritama za filtriranje sadržaja te analizirati prednosti i nedostatke takvih
pristupa. Analizirat će se posebni zahtjevi na preporučiteljske sustave
od strane sveprisutnih aplikacija. Prikazat će se principi rada osmišljenog
preporučiteljskog sustava, te će se analizirati komponente istog sustava. Na
kraju prikazat će se jednostavno testiranje izgrađenog sustava na konkretnom
scenariju.

\chapter{Sveprisutno računarstvo}
\section{Uvod u sveprisutno računarstvo}

Termin \glqq Sveprisutno računarstvo\grqq prvi je upotrijebio Mark Weiser u
svom vizionarskom članku u kojem je rekao kako su najkorisnije
one one tehnologije koje nestaju, u smislu da korisnici izgube pojam o
korištenju te tehnologije \cite{computer21}. U tom smislu sveprisutno
računarstvo podrazumjeva skup onih tehnologija i načela koja omogućuju
ugrađivanje računala u svakodnevne korištene predmete. Takvi predmeti koristili
bi se za potporu u svakodnevnim aktivnostima dok bi bili jednako primjenjivi u
poslovnom okruženju, upravljanju prostorima, igrama i sl \cite{Krumm2009}.

Cilj filozofije sveprisutnog računarstva nije staviti čovjeka u svijet računala
nego integracija računala u svijet čovjeka. Praktična posljedica toga jest
pojava velike količine mahom nestrukturiranih podataka koje mogu predstavljati
izvrstan materijal za daljnju obradu i izučavanje algoritama kojima se ti podaci
mogu upotrijebiti za analizu ponašanja čovjeka ili za pomoć u svakodnevnim
poslovima \cite{VukoticTankovic}.



\section{Razvoj}
Sveprisutno računarstvo treći je veliki val u računalnom razdoblju. Prvi val
jest val radnih stanica \engl{Mainframe} koji je karakterizirao upotreba jednog
račuala na više osoba. Drugi val je i danas naveliko prisutan, a to je val
osobnih računala \engl{PC, Personal Computer} koji karakterizira upotreba jednog
računala po osobi. Treći val, val sveprisutnog računarstva karakterizira veliki
i brzi razvoj malih, umreženih i prijenosnih računala koji rezultira korištenjem
više računala od strane jedne osobe \cite{Krumm2009}. Razvoj sveprisutnog
računarstva započeo je devedesetih godina prošlog stoljeća u \emph{Xerox PARC}
laboratorijima, a nastavlja se do danas potaknut strelovitim napretkom
tehnologije potrebne za ostvarivanje sveprisutnih koncepata.

\begin{figure}[H]
	\centering
	\includegraphics[width=12cm]{images/majortrends2.png}
	\caption{Tri vala u računarstvu}
	\label{fig:majortrends}
\end{figure}

\section{Zahtjevi}
Elementarni zahtjevi potječu od dvaju osnovnih atributa sveprisutnog računarstva
prema klasifikaciji Marka Weisera \cite{Weiser93}:
\begin{itemize}
  \item Sveprisutnost - sustav je takav da je uvijek dostupan na zahtjev
  korisnika
  \item Transparentnost - sustav je integriran u svakodnevnu okolinu i prikriven
  za krajnjeg korisnika
\end{itemize}

S druge strane, dodatni zahtjevi potječu od dvodimenzionalnih granica koje
odvajaju sveprisutno računarstvo od drugih istraživačkih područja (slika
\ref{fig:ubiqreq}) \cite{Maffioletti2001}:
\begin{itemize}
  \item Mobilnost korisnika - u interakciji sa sustavom, korisnik mora moći
  imati slobodu kretanja.
  \item Transparentnost sučelja - odnosi se na količinu pažnje koju korisnik
  mora posvetiti za upravljanje sustavom i percepciju izlaza.
\end{itemize}

\begin{figure}[H]
	\centering
	\includegraphics[width=12cm]{images/ubiqreq.png}
	\caption{Grafički prikaz smještaja sveprisutnog računarstva}
	\label{fig:ubiqreq}
\end{figure}

Iz navedenih elementarnih zahtjeva, prirodno se nameću konkretni zahtjevi na
implementaciju sveprisutnih i prožimajući računalnih sustava. S obzirom na
fizički dio, zahtjevi mogu biti:
\begin{itemize}
  \item Fizički mali uređaji ili senzori koji se koriste u prostoru
  \item Sposobnost interakcije s okolinom što nužno vodi do zahtjeva
  na umrežavanje bilo kojim protokolom, žično ili bežično, na manjoj ili većoj
  udaljenosti
  \item Sučelje za prikaz podataka ili interakciju s korisnikom, dovoljno
  transparentno da se postigne iluzija da se računalo ne koristi ili da to
  računalo ne bude u žarištu pažnje
  \item Mala energetska potrošnja
  \item Razmjerno mala i ekonomična cijena
\end{itemize}

Analogno fizičkim zahtjevima, funkcionalni zahtjevi na sveprisutni računalni
sustav slijede iz elementarnih zahtjeva:
\begin{itemize}
  \item Korištenje otvorenih računalnih standardna radi podložnosti promjeni
  računalnih programa i uređaja. Preferira se korištenje virtualnih strojeva na
  kojima se izvode programi bez svijesti o konkretnoj arhitekturi
  (enkapsulacija računalne arhitekture). Primjeri takvih strojeva su \emph{Java
  virutal machine} ili \emph{Common language runtime}
  \item Sustav nevidljivih datoteka, tj. enkapsulacija konkretnog datotečnog
  sustava u vidu hijerarhije direktorija, naziva datoteka, smještaja datoteka i
  sl.
  \item Automatska instalacija programa radi neprimjetne migracije s jednog
  računala na drugo računalo
  \item Sakupljanje podataka i razmjena istih u okruženju bez prisustva
  korisnika bez kršenja pravila i licenci privatnosti
  \item Personaliziranost informacija u smislu prilagođavanja računalnog sustava
  korisniku na svim razinama
  \item Privatnost personaliziranih informacija i svih onih informacija koje se
  mogu dovesti u vezu s konkretnim korisnikom i tako na bilo koji način ugroziti
  njegovu sigurnost
\end{itemize}

\section{Primjena}

Koncepti sveprisutnog računarstva, iako je ono još u zamahu, već su primjenljivi
na razne segmente svakodnevnice. Koncept pametnih gradova danas se može vidjeti
u većim Europskim gradovima, pa su tako stanice javnog prijevoza opremljene
zaslonima i računalima koji u stalnoj vezi sa središnjim poslužiteljem u realnom
vremenu prikazuju lokaciju sredstva javnog prijevoza. Pametni prostori u vidu
pametnih kuća uz znatnije investicije omogućuju korisnicima ugodnije i
jednostavnije obavljanje svaodnevnih aktivnosti kod kuće. Ondje gdje još
nema uvjeta za prožimanje okoline računalima postoji izvjestan stupanj
integracije postojećih tehnologija sa suvremenim tehnologijama. Primjerice,
orjentacija u muzejskim ili sajmišnim prostorima pomoću pametnih telefona.

Općenito, sveprisutno računarstvo ima jako velik potencijal u tzv.
\emph{urbanom računarstvu} pa se tako njegovi koncepti mogu primjeniti na:

\begin{itemize}
  \item Općenite javne i komercijalne infrastrukture
  \item Mobilne i druge bežične mreže
  \item Kolektivni transport, prvenstveno u vidu javnog gradskog prijevoza
  \item Plaćanje i novčane transakcije
  \item Sigurnost i nadgledanje
  \item Rasprostranjeno i ciljano reklamiranje
  \item Pametnu arhitekturu
  \item Osobnu komunikaciju
  \item Servise mahom implicitnih društvenih mreža
  \item Urbanu umjetnost
  \item Urbani krajolik u smislu prikaza skrivenih slojeva koji sami po sebi
  fizički nisu vidljivi, pa tako ovaj koncept analogno odgovara izumu mikroskopa
\end{itemize}

\chapter{Preporučiteljski sustavi}
\section{Uvod u preporučiteljske sustave}
Preporučiteljski sustavi su, ukratko rečeno, podrazred sustava za filtriranje
podataka kojima je svrha predviđanje ocjene (ili preferencije) kojom bi neki
korisnik ocijenio neki predmet u sustavu \cite{RSHandbook} Predmeti nad kojima
takvi sustavi rade, kao i korisnici tog sustava opisani su određenim
karakteristikama, odnosno važnostima tih karakteristika za korisnike. Općenito,
može se reći da je jednostavan model preporučiteljskog sustava dan formulom:
\begin{equation}
\label{eq:elementarniModel}
	R \leftarrow U \times I
\end{equation}
gdje je $R$ rezultat, tj. predikcija \engl{prediction, recommendation},
ocjene korisnika $U$ \engl{ user} koji je zatražio preporuku, tj. filtriranje
sadržaja , a $I$ predmet nad kojim se vrši predikcija ocjene \engl{item}.
Drugim riječima, predikcija je posljedica karakteristike, tj. preferencije
korisnika, te karakteristike predmeta. Traženje potencijalnih preporuka za
korisnika $U$ tada se u najjednostavnijem slučaju svodi na kombiniranje profila
njegovih preferencija s profilima predmeta u skupu svih predmeta dostupnih
algoritmu za filtriranje.
Dakle, preporuka $R$ zapravo je predviđanje ocjene korisnika $U$ za
traženi predmet $I$. Krajnji rezultat na kraju jest najčešće lista od $n$
najboljih preporuka, tj. pretpostavki da bi korisnik te predmete ocjenio
najbolje \engl{top -- $N$ list}. 

Gornji model ima dva osnovna i lako uočljiva ograničenja:
\begin{enumerate}
  \item Traženje preporuka za korisnika svodi se na iscrpno pretraživanje
  prostora predmeta dostupnih algoritmu za filtriranje
  \item Rezultat je preporuka kojoj fali bilo kakav kontekst.
\end{enumerate}

U svrhu riješavanja gore navedenih problema, razmotrit će se razni modeli
preporuke od kojih su neki već dobro poznati i korišteni algoritmi. Neka je $C$
kontekst u kojem korisnik $U$ traži preporuku. Formula \ref{eq:elementarniModel}
tada prelazi u:
\begin{equation}
\label{eq:elementarniModelSKontekstom}
	R \leftarrow U \times I \times C
\end{equation}
dok predikcija $R$ postaje posljedica karakteristike, tj. preferencije
korisnika, karakteristike predmeta i konteksta u kojem se vrši predikcija.
Kontekst $C$ se ne shvaća atomarno i u sebi može sadržavati više različitih
komponenata koje mogu utjecati na preporuku, npr:
\begin{itemize}
  \item Vrijeme predikcije
  \item Mjesto na kojem se traži predikcija
  \item Prisutnost drugih korisnika u trenutku predikcije
  \item Skupine predmeta, odnosno resursa, koje se nalaze u blizini
\end{itemize}

Predmet se shvaća generički i on može varirati ovisno o kontekstu primjene,
primjerice, artikli u internet trgovini, knjige u digitalnim knjižnicama, pjesme
i filmovi namultimedijalnim servisima, rezultati pretraživanja na tražilicama,
osobe na društvenim mrežama, smjerovi kretanja u prostoru i u ovisnosti s
vremenom itd. Svaki predmet u korišten od strane algoritma za filtriranje obično
je opisan nekim karakteristikama koji variraju u ovisnosti o kontekstu predmeta.
Tako primjerice neka pjesma može biti opisana žanrom, trajanjem i izvođačem, a
knjiga isto tako žanrom, autorom i brojem stranica. Unositi težine za pojedine
ocjene karakteristika predmeta nije uobičajeno jer na taj način dolazi do
subjektiviziranja rezultata filtriranja na manji skup osoba, ali s druge strane
gledano, nije ni nemoguće.

S druge strane, korisnici sustava imaju različite scenarije korištenja
preporučitelja od kojih su osnovni filtriranje neželjenog sadržaja iz velikih
baza podatak i savjetovanje pri nedostatku vlastite kompetencije za izbor
sadržaja \cite{AskIda}. Korisnici imaju svoje preferencije koje su u ovom
slučaju uglavnom opisane težinama jer prema različitim potrebama određene
karakteristike predmeta nad kojima se vrši filtriranje mogu biti zanimljivije,
odnosno manje zanimljive.
%TODO: SVD tu negdje?

Interakcijom korisnika sa sustavom omogućuje se praćenje njegovih odabira,
treniranje preporučitelja te kroz analizu profila korisnika i njegovih osobnih
preferencija stvaranje modela za preporuku predmeta na nekoliko načina. Podaci
koje korisnik ostavlja u sustavu u osnovi se mogu podijeliti u dva skupa:
\begin{enumerate}
  \item Implicitni
  \item Eksplicitni
\end{enumerate}
Implicitni podaci su oni podaci koje je sustav prikupio od korisnika bez da ga
je to eksplicitno zatražio. Takvi podaci mogu biti primjerice, demografski
podaci, točnije, šire područje iz kojeg korisnik koristi sustav a jednostavno se
doznaje iz baze podataka dodijeljenih područja \engl{scope} IP adresa.
Također, pod implicitne podatke spadaju i akcije korisnika u sustavu koje se
mogu doznati iz sjedničkih zapisa, kao i tzv. klikovi na određene poveznice
unutar sustava.

S druge strane, eksplicitni podaci su oni koje korisnik ostavlja s namjerom,
primjerice koristeći ankete o svojim preferencijama, ostavljajući povratnu
informaciju na ponuđene predmete \engl{feedback} ili odgovarajući na bilo
koji način na upite o pojedinim predmetima.

U općem slučaju, preporučiteljske sustave razlikujemo prema načinu filtriranja i
analiziranja informacija, a razlikujemo četiri osnovna načina:
\begin{enumerate}
  \item Filtriranje neovisno o korisniku \engl{Non -- personalized
  filtering}
  \item Filtriranje zasnovano na sadržaju \engl{Content -- based
  filtering}
  \item Filtriranje zasnovano na suradnji \engl{Collaborative
  filtering}
  \item Hibridne tehnike filtriranja odnosno preporučivanja
\end{enumerate}
Iako se tehnički iz filtiranja neovisnog o korisniku može izgraditi
preporučiteljski sustav, on to nije u punom smislu riječi jer praktički
izostavlja ulogu korisnika u sustavu. Drugim riječima, svaki korisnik će dobiti
istu preporuku. Zbog toga ga se može nazvati svojevrsnim
\emph{pseudopreporučiteljem}.

\section{Razvoj preporučiteljskih sustava}
Povijesno gledano, razvoj preporučiteljskih sustava započeo je devedesetih
godina prošlog stoljeća, a nemalo je populariziran $2006$. g. svojevrsnim
natjecanjem \glqq The Netflix Prize \grqq kada je poznati pružatelj multimedije
na zahtjev ponudio nagradu od \$$1,000,000$ američkih dolara za tim koji razvije
preporučitelj bolji od taga postojećeg sustava \glqq Cinematch \grqq za određeni
postotak \cite{Bennett2007}.
Ovo je ostavilo velik utjecaj na razvoj preporučitelja prvenstveno zbog
činjenice da je u uvjetima natjecanja navedeno da rezultati i principi rada
razvijenih preporučitelja moraju biti javno objavljeni i dostupni
%referenca

\section{Filtriranje neovisno o korisniku}
%TODO negdje ubaciti kako zapravo dobiti preporuku (top N)
Osnovni model filtriranja jest filtriranje neovisno o korisniku. Model preporuke
koji proizlazi iz ovakvog načina filtriranja, strogo gledano, ne može biti
preporučitelj jer preporuka ne ovisi strogo o korisniku. Drugim riječima, svaki
korisnik koji zatraži preporuku od ove vrste filtriranja dobit će istu
preporuku. Ova tvrdnja može se jednostavnije prikazati relacijom:
\begin{equation}
\label{eq:filtriranjeNeovisnoOKorisniku}
	R \leftarrow I
\end{equation}
gdje je $R$ predikcija, tj. preporuka, a $I$ predmet. Iz relacije
\ref{eq:filtriranjeNeovisnoOKorisniku} očigledno je da je predikcija funkcija
isključivo predmeta, pa kao takva ne može biti smatrana punokrvnim
preporučiteljem. S druge strane, isplati se proučiti ovu vrstu filtriranja jer
neki njezini koncepti vrijede u općem slučaju, npr. sustav ocjenjivanja i sustav
prikazivanja rezultata.

Razmjerno jednostavna predožba ovog modela jest rejting \engl{Rating}. Neka je
dan neki servis za ocjenjivanje i korisničke recenzije ugostiteljskih objekata.
Neka svaki korisnik koji je koristnio uslugu nekog od objekata ima pristup
sustavu u kojem može u više kategorija ostaviti ocjenu iz nekog intervala s
pisanom recenzijom. Također, neka svaki korisnik ima mogućnost ocijeniti uslugu
brojčanom ocjenom iz intervala od jedan do pet. Model preporučitelja u tom
slučaju je opisan s:
\begin{equation}
\label{eq:skupOcjena}
	S = \{1, 2, 3, 4, 5\}
\end{equation}
\begin{equation}
\label{eq:prosjek}
	R = \lfloor \frac{\sum_{i=1}^{N} s_i}{N} \ast 10 \rfloor
\end{equation}
gdje je $S$ skup mogućih ocjena, $R$ konačan rejting predmeta, $N$ ukupan broj
korisnika koji su ocjenili taj predmet, a $s_i$ ocjena $i$-tog korisnika. Iako
izgrađeni model preporuke strogo gledano nije preporučitelj, on to ipak čini
posredno nudeći korisniku ono što su drugi korisnici obilježili kao poželjnije.
Ovakav model obično koriste usluge s povratnom informacijom korisnika
\engl{Feedback}, npr. \emph{eBay}, \emph{Tripadvisor} i \emph{Zagat}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/neosobni/ebay1.png}
	\caption{Primjer rejtinga na internetskoj aukcijskoj kući \emph{eBay}}
	\label{fig:Ebay1}
\end{figure}

Elementi ovog preporučitelja prikazani relacijama \ref{eq:skupOcjena} i
\ref{eq:prosjek} mogu se varirati kako bi se prilagodio izgrađeni model drugim
sustavima, primjerice:
\begin{itemize}
  \item Skup ocjena $S$. Ovisno o potrebi, moguće je skup proširiti do potrebnog
  broja ocjena, imajući na umu da veća granulacija nije nužno bolja, kao i da
  može biti beskorisna u vidu onemogućenja korisnika da predmet ocjeni spontano,
  a da neće biti vidljiva u krajnjem rezultatu. Također, granulaciju je moguće
  povećati dozvoljavanjem ocjena van skupa cijelih brojeva.
  \item Prikaz rezultata $R$. U formuli \ref{eq:prosjek} prije zaokruživanja
  prosjek je pomnožen faktorom $10$ radi eliminacije decimala. Moguće je
  odabrati neki drugi prikaz rezultata, primjerice u postotcima (slika
  	\ref{fig:Ebay2}).
\end{itemize}
Preporuka korisniku na kraju se jednostavno svodi na prikaz prvih $N$ najboljih
prosječnih ocjena.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=5cm]{images/neosobni/ebay2.png}
	\caption{Implicitna preporuka trgovca izražena postotcima}
	\label{fig:Ebay2}
\end{figure}

Sam način ocjenjivanja ne mora nužno biti eksplicitna dodjela ocjene. Moguće je
primjerice koristiti sustav glasovanja \engl{Vote up/down} \engl{Vote
up/down}. Pomoću takvog sustava, korisnici masovno određuju koji je sadržaj
kvalitetniji, odnosno, koji je manje kvalitetan te na taj način vrše implicitnu
preporuku. Primjer je internetska stranica za programerska pitanja i odgovore
\emph{StackOverflow} (slika \ref{fig:stackoverflow1}). Na ovoj stranici, nakon
postavljenog pitanja, korisnici daju odgovore, a sustav na više pozicije
postavlja one odgovore kojima su korisnici dali više glasova, a na niže pozicije
lošije i negativno rangirane odgovore. Također, korisnici mogu glasovati na
kvalitetu postavljenog pitanja pa time nekvalitetna i loše postavljena pitanja
eliminirati (tj. ne preporučiti) za odgovaranje. 

\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/neosobni/stackoverflow1.png}
	\caption{Primjer rejtinga na internetskom portalu \emph{StackOverflow}}
	\label{fig:stackoverflow1}
\end{figure}

Drugi najpoznatiji primjer koji koristi takav sustav dodjele ocjena jest
internetski portal \emph{Reddit} (slika \ref{fig:reddit1}).
\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/neosobni/reddit1.png}
	\caption{Primjer rejtinga na internetskom portalu \emph{Reddit}}
	\label{fig:reddit1}
\end{figure}

%TODO: Ovo kao da je nabacano, i ovo iznad i ovo ispod ove linije?
U općem slučaju modeli preporučitelja zasnovani na ovakvoj vrsti filtriranja
imaju dvije mane:
\begin{itemize}
  \item Zavaravanje korisnika od strane rejtinga koji je, neovisno o načinu
  prikaza, i dalje samo prosjek pojedinačnih ocjena.
  \item Nedostatak konteksta za preporuke.
\end{itemize}

Nepersonalizirana preporuka može se izvesti i asocijativno, traženjem implicitne
korelacije između dvaju ili više predmeta. Naivno gledano, može se zaključiti
ako je relativna većina korisnika uz kupnju nekog proizvoda $i_1$ kupila i
proizvod $i_2$, da bi i budućim korisnicima trebalo uz proizvod $i_1$
preporučiti proizvod $i_2$, i obrnuto. Ova tvrdnja može se opisati formulom
\ref{eq:NaivnaNep}:

\begin{equation}
\label{eq:NaivnaNep}
	R = \frac{\mid X \cap Y \mid}{\mid X \mid}
\end{equation}
gdje je $X$ skup svih korisnika koji su kupili predmet $i_1$, $Y$ skup svih
korisnika koji su kupili predmet $i_2$ a $R$ ocjena ovisnosti između predmeta
$i_1$ i $i_2$. Zbog činjenice da je kardinalni broj presjeka dvaju skupova
uvijek manji ili jednak kardinalnom broju bilo kojeg od ta dva skupa, ocjena $R$
nalazi se u intervalu $0 \leq R \leq 1$.

Problem ove metode preporučivanja jest navedeni nedostatak konteksta za
preporuke. Taj nedostatak može se manifestirati u činjenici da su neki predmeti
neovisno popularni. Primjerice, ako je neki predmet popularan, naivni
preporučitelj može koristeći \ref {eq:NaivnaNep} (opravdano) stvoriti vezu
između tog predmeta i bilo kojeg drugog predmeta. Primjer dan u
\cite{courseraRC} pokazuje kako su u nekom sustavu posebno popularan predmet
banane i kako naivni preporučitelj stvara veze između banana i nekih drugih
generičkih predmeta, pa onda pri kupnji banana preporučuje te generičke predmete
i obratno. Ovaj efekt može se eliminirati normalizacijom relacije
\ref{eq:NaivnaNep}:

\begin{equation}
\label{eq:nepersonalizirani}
	R = \frac
		{\frac
			{\mid X \cap Y \mid}
			{\mid X \mid}}
		{\frac
			{\mid \overline{X} \cap Y\mid}
			{\mid \overline{X} \mid}}
\end{equation}
gdje su $X$ i $Y$ skupovi svih korisnika koji su kupili predmete $i_1$ i $i_2$
respektivno.

\section{Filtriranje ovisno o korisniku}
Grubi model filtriranja ovisnog o korisniku, prema relaciji
\ref{eq:elementarniModel} računa predikciju kao produkt karakteristike predmeta
i preferencije korisnika, no zanemaruje kontekst, osim ako on nije implicitno
uključen u komponentu korisnika ili predmeta. U općem slučaju razlikuju se dvije
vrste filtriranja ovisnog o korisniku: filtriranje zasnovano na sadržaju te
suradničko filtriranje.

\subsection{Filtriranje zasnovano na sadržaju}
U gotovo svim primjenama preporučitelja, tj. u sustavima u kojima se oni
koriste, predmeti ili korisnici nisu osnovne (atomarne) jedinice, nego ih se
može opisati nekim kategorijama, primjerice, demografskim podacima za korisnika,
autorom i izdavačem ako je predmet neka knjiga i sl. Preporučivanje zasnovano
na sadržaju u osnovi dovodi u vezu prikupljene preferencije korisnika, bilo
eksplicitno, bilo promatrajući povijest ponašanja, i karakteristike kojima je
opisan neki predmet \cite{RSHandbook}. Na slici \ref{fig:contentnonpers} vidljiv
je primjer preporučiteljskog rezultata bez ikakvih informacija o korisniku.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/content/nepersonalizirani.png}
	\caption{Preporuka zasnovana na sadržaju i implicitno prikupljenim podacima}
	\label{fig:contentnonpers}
\end{figure}

Podaci na temelju kojih je generirana preporuka prikupljeni su implicitno, u
vidu grube lokacije korisnika (na slici je lokacija Ujedinjeno Kraljevstvo). S
druge strane, slika \ref{fig:contentpers} prikazuje uključene podatke o
korisniku, pa je lako vidljiva značajna razlika u generiranoj preporuci između
dvije verzije preporučitelja u kojoj isti algoritam ima pristup različitim
širinama skupova informacija. 

\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/content/personalizirani.png}
	\caption{Preporuka zasnovana na sadržaju i eksplicitno personalizirana}
	\label{fig:contentpers}
\end{figure}

Neka je u sustavu koji koristi preporučitelj zasnovan na sadržaju svaki predmet
opisan tekstualnim medapodacima i vektorom:
\begin{equation}
\label{eq:vektorKarakteristika}
	\boldsymbol{X_i} = 
		\big[ 
			\boldsymbol{w_{1,i}}, 
			\boldsymbol{w_{2,i}}, 
			\boldsymbol{w_{3,i}}, 
			\ldots, 
			\boldsymbol{w_{N,i}} 
		\big]^T
\end{equation}
gdje je $\boldsymbol{w_{j,i}}$ kvantitativni, tj. brojčani opis neke $j$-te
karakteristike za $i$-ti predmet. Težina je neka proizvoljno odabrana metrika
koja može varirati od jednostavnog broja pojavljivanja, uključujući $0/1$
pristup (karakteristika je primjenjiva, odnosno karakteristika nije
primjenjiva) do precijznijih metrika. Sličnost između dvaju predmeta, $i_1$ i
$i_2$ moguće je tada izraziti kosinusom kuta između vektora njihovih
karakteristika:
\begin{equation}
\label{eq:kosinus}
	\boldsymbol{cos}(\boldsymbol{I}_1, \boldsymbol{I}_2) = 
		\frac
			{\boldsymbol{I}_1 \ast \boldsymbol{I}_2}
			{\|\boldsymbol{I}_1\| \times \|\boldsymbol{I}_2\|}
\end{equation}
Teoretski, svaka karakteristika može imati svoju težinu, u smislu da može biti
važnija, odnosno manje važna za opis nekog predmeta. Taj pristup svodi se na
algoritam \emph{Redukcije dimenzija} i dekompoziciju matrice na singularne
faktore, a bit će opisan naknadno.

Neka također za svakog korisnika postoji korisnički profil sa dostupnim
preferencijama korisnika dostupnim u vektorskom zapisu gdje $i$-ta komponenta
vektora predstavlja težinu te karakteristike za korisnika. Tada je na sličan
način moguće izraziti kompatibilnost promatranog korisnika i predmeta:
\begin{equation}
\label{eq:cosUserItem}
	\boldsymbol{cos}(\boldsymbol{U}, \boldsymbol{I}) = 
		\frac
			{\boldsymbol{U} \ast \boldsymbol{I}}
			{\|\boldsymbol{U}\| \times \|\boldsymbol{I}\|}
\end{equation}

%TODO: ubaciti TFIDF

Vektore je poželjno normalizirati, TFIDF

S obzirom na relacije \ref{eq:kosinus} i \ref{eq:cosUserItem} slijedi algoritam
za preporučivanje zasnovano na sadržaju.

\begin{algorithm}[H]
	\caption{Filtriranje zasnovano na sadržaju}
	\label{algo:content}
	\begin{algorithmic}[1]
		\STATE{\textbf{Ulaz:} $k$ - vektor ocjena korisnika. $I$ - matrica u kojoj su
		retci predmeti, a stupci karakteristike}
		\STATE{\textbf{Izlaz:} Lista $L$ najboljih $N$ predmeta za korisnika $k$}
		\STATE{$L := initList(N);$}
		\STATE{$idfPolje := initPolje(width(I)); userPolje := initPolje(width(I))$}
		
		%PRVA FAZA ALGORITMA, NORMALIZIRATI VEKTOR ZA SVE ITEME
		%Vanjska for petlja koja ide po svim itemima
		\FOR{($i := 0; i < height(I); inc(i)$)}
			%Unutarnja for petlja ide po svim karakteristikama
			\STATE{$suma := 0$}
			\FOR{($j := 0; j < width(I); inc(j)$)}
				\IF{($i_j \neq 0$)}
					\STATE{$inc(suma);$}
				\ENDIF
			\ENDFOR
			\FOR{($j := 0; j < width(I); inc(j)$)}
				\STATE{$i_j := 1/\sqrt{suma};$}
			\ENDFOR
		\ENDFOR
		
		%DRUGA FAZA ALGORITMA, KREIRATI USER PROFILE vektorskim produktom korisnika i
		% karakteristike
		%TREĆA FAZA ALGORITMA, izračunati IDF
		\STATE{$count := 0;$}
		\FOR{$(i := 0; i < width(I); inc(i))$}
			\FOR{$(j := 0; j < height(I); inc(j))$}
				\STATE{$userPolje_i := userPolje_i + I_{i,j} * k_j;$}
				\IF{($I_{i,j} \neq 0$)}
					\STATE{$inc(count);$}
				\ENDIF
			\ENDFOR
			\STATE{$idfPolje_i := 1/count;$}
			\STATE{$count := 0;$}
		\ENDFOR
		
		\STATE{$L_i := L_i + i_j \ast idf_j \ast userProfile_j$}

		%ČETVRTA FAZA ALGORITMA, predikcija= idf*profil*predmet
		\FOR{$(i := 0; i < height(I); inc(i))$}
			\FOR{$(j := 0; j < width(I); inc(j))$}
				\STATE{$L_i := L_i + I_j \ast userProfile_j \ast idfPolje_j;$}
			\ENDFOR
		\ENDFOR
		
		\RETURN{$L$}
	\end{algorithmic}
\end{algorithm}

Jedna od većih prednosti ovog načina filtriranja jest što može stvarati
preporuke neovisno o tome je li za predmet davana povratna informacija ili ne.
Drugim riječima, ovaj način filtriranja iznimno je prikladan na početku rada
sustava jer nema problema s takozvanim hladnim početkom \engl{Cold start}.
Isto tako, prikladan je za primjene gdje je moguće relativno dobro strukturiranim
karakteristikama opisati predmete. S druge strane, nepogodan je ukoliko ga
se implementira u sustave gdje korisnici dolaze rijetko ili relativno često
mijenjaju preferencije. Zbog svega navedenog, ova vrsta filtriranja uglavnom se
upotrebljava u sustavima za pregledavanje vijesti, personaliziranim servisima za
multimediju, video na zahtjev i sl.

\subsection{Filtriranje zasnovano na suradnji}
Suradnički pristup dijametralno je suprotan sadržajnom pristupu. Princip rada
ove vrste filtriranja suradnja je između pojedinih korisnika odnosno predmeta.
Definicija ove vrste suradnje zapravo leži u određivanju sličnosti između dvaju
korisnika ili predmeta, a glavna premisa jest da preferencije predmeta uglavnom
važe za sve korisnike koji imaju iste interese ili su slično ocijenili slične
predmete. Primjerice, razmatranjem slučaja gdje dva različita korisnika dodijele
dvije relativno slične ocjene nekom predmetu, zaključak jest da je vjerojatnost
da su ta dva korisnika slično ocjenila i neke druge predmete razmjerno velika. S
druge strane, veća je vjerojatnost da će neki korisnik ocjeniti slično neka dva
predmeta ako su ih i ostali korisnici slično ocjenili.

Zbog usporedbi i rada na dvije različite razine, korisničkoj i predmetnoj, ovaj
preporučitelj se u osnovi dijeli na dvije moguće tehnike:
\begin{itemize}
  \item Korisnik-korisnik \engl{User-user, Neighbourhood-based,
  Memory-based}
  \item Predmet-predmet \engl{Item-item, Item-based, Model-based}
\end{itemize}

\subsubsection{Korisnik -- Korisnik}
Suradničko filtriranje na relaciji između korisnika koji traži preporuku i
ostalih korisnika sustava svodi se na predikciju ocjene korisnika koji traži
preporuku za neki predmet na osnovu ocjena njemu bliskih ljudi. Neka je $K$ skup
svih korisnika nekog sustava. Također, neka je $k$ korisnik iz skupa $K$ koji
traži preporuku za neki predmet. Tada je susjedstvo $N$ korisnika $k$
definirano kao:
\begin{equation}
\label{eq:susjedstvo}
	N = K \backslash \{k\}
\end{equation}

Bliskost, odnosno udaljenost dvaju korisnika dobro je definirana nekom metrikom,
npr. Pearsonovim koeficjentom korelacije (\ref{eq:pearsonKorisnik}):
\begin{equation}
\label{eq:pearsonKorisnik}
	R = \frac
			{\sum_{i \epsilon I} 
				\big[
					(r_{k,i} - \overline{r_k}) \ast
					(r_{u,i} - \overline{r_u})
				\big]
			}
			{
				\sqrt{{\sum_{i \epsilon I} (r_{k,i} - \overline{r_k})^2}} \ast 
				\sqrt{{\sum_{i \epsilon I} (r_{u,i} - \overline{r_u})^2}}
			}
\end{equation}
gdje je $w_{q,u}$ težina između aktivnog korisnika $k$ i korisnika $u$, $i$ skup
predmeta koje su ocijenila oba korisnika, $r_{u,i}$ ocjena koju je korisnik $u$
dodijelio predmetu $i$, a $\overline{r_u}$ srednja vrijednost svih ocjena koje
je dodijelio korisnik $u$.
Alternativno, ocjene korisnika mogu se predstaviti kao vektore u $m$ -
dimenzionalnom prostoru pa se udaljenost, tj. bliskost može izraziti preko
skalarnog produkta kao kosinus kuta između ta dva vektora:
\begin{equation}
\label{eq:pearsonKosinus}
	w_{k,u} = 
		\cos{(\vec{r_k}, \vec{r_u})} = 
		\frac
			{\vec{r_k} \ast \vec{r_u}}
			{\|\vec{r_k}\| \times \|\vec{r_u}\|} = 
		\frac
			{\sum_{i=1}^m r_{k,i} \ast r_{u,i}}
			{\sqrt{\sum_{i=1}^m r_{k,i}^2} \ast \sqrt{\sum_{i=1}^m r_{u,i}^2}}
\end{equation}
Mana pristupa \ref{eq:pearsonKosinus} jest nedostatak negativnih ocjena. 

Iako prema \ref{eq:susjedstvo} u susjedstvo spadaju svi korisnici sustava, u
praksi se uzima najbližih $n$ određenih pomoću \ref{eq:pearsonKorisnik} ili
\ref{eq:pearsonKosinus}. S obzirom na tu činjenicu i navedene relacije, slijedi
relacija za izračun predviđanja:
\begin{equation}
\label{eq:preduseruser}
	p_{u,i} =
		\overline{r_u}+
		\frac
			{\sum_{j = 1}^n (r_{j} - \overline{r_j}) \ast w_j}
			{\sum_{j = 1}^n w_j}
\end{equation}
gdje je $p_{u,i}$ predviđanje ocjene korisnika $u$ za predmet $i$, $r_j$ ocjena
koju je $j$ susjed korisnika $u$ dao predmetu $i$, $\overline{r_j}$ prosjek
ocjena koje dodjeljuje korisnik $j$, $w_j$ težina između korisnika $u$ i susjeda
$j$, a $\overline{r_u}$ prosjek ocjena koje dodjeljuje korisnik $u$.
$\overline{r_u}$ i $\overline{r_j}$ su zapravo normalizacijski članovi jer
različiti korisnici mogu imati individualne kriterije i skale. 

Algoritam za filtriranje na relaciji korisnik-korisnik slijedi:
\begin{algorithm}[H]
	\caption{Korisnik-korisnik filtriranje}
	\label{algo:korisnik-korisnik}
	\begin{algorithmic}[1]
		\STATE{\textbf{Ulaz:} $k$ - korisnik za kojeg se traži predikcija. $I$ -
		matrica ocjena korisnika gdje su stupci predmeti, a retci korisnici. $N$ -
		veličina susjedstva}
		
		\STATE{\textbf{Izlaz:} Lista $L$ najboljih predmeta za korisnika $k$.}
		\STATE{$L := initList(width(I));$}
		\STATE{$I^T := transpose(I);$}
		\STATE{$correlMatrix := calculatePearsonElementwise(N, N^T)$;}
		
		\STATE{$k_a := calculateAverageForUser();$}
		\STATE{$A := calculateAveragesForNeighborhood();$}
		
		\STATE{$topNForUser := sort(row(correlMatrix_k)).takeFirstN;$}
		%Iteracija po predmetima
		\FOR{($i := 0; i < width(I) ;inc(i)$)}
			\STATE{$sum := 0;$}
			\STATE{$sumWeight := 0;$}
			%Iteraija po susjedima
			\FOR{($j := 0; j <= N; inc(j)$)}
				\STATE{$sum := sum + ((I_{i,j} - A_j) \ast correlMatrix_{k,j})$}
				\STATE{$sumWeight := sumWeight + correlMatrix_{k,j};$}
			\ENDFOR
			\STATE{$L_i := k_a + (sum/sumWeight);$}
		\ENDFOR
		\RETURN{sort(L);}
	\end{algorithmic}
\end{algorithm}
Indeks $j$ u algoritmu \ref{algo:korisnik-korisnik} se odnosi na onaj redak,
odnosno stupac matrice po referenci na promatranog susjeda, a ne slijedno od
nultog elementa matrice.

Algoritam se ugrubo svodi na:
\begin{enumerate}
  \item Račun korelacije između svih korisnika u sustavu korištenjem
  \ref{eq:pearsonKorisnik}
  \item Odabir $n$ susjeda koji imaju najveće težine s obzirom na korisnika $k$
  gdje je broj tih susjeda ($topN$) određen empirijski.
  \item Izračun prosječne ocjene kojom svaki susjed $n \in N$ ocjenjuje predmete
  \item Izračun prosječne ocjene kojom ocjenjuje korisnik $k$
  \item Izračun predviđanja korištenjem normalizacijske formule
  \ref{eq:preduseruser}
\end{enumerate}

Primjer korištenja ovog pristupa je \glqq MovieLens\grqq sustav razvijen od
strane istraživačke skupine \glqq GroupLens\grqq \cite{MovieLens}. Taj
preporučitelj na temelju korisničkih ocjena i odabira traži slične korisnike
sustava te krajnjem korisniku daje listu filmova koji su dovoljno dobro
ocjenjeni od strane tih sličnih korisnika. Primjer je vidljiv na slici
\ref{fig:movielens}.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/collaborative/movielens.png}
	\caption{Primjer preporuke sustava \glqq MovieLens\grqq}
	\label{fig:movielens}
\end{figure}

Ovaj pristup je relativno efikasan i jednostavan za implementaciju, ali druge
strane, računalno postaje vrlo zahtjevan ako se primjeni na velike baze podataka
korisnika i predmeta. Računanje transponirane matrice u općem slučaju je
složenosti $O((n \ast (n-1)) / 2)$. Računanje Pearsonovog koeficjenta korelacije
između svih korisnika iznosi $O(n^3 / 2)$ jer je složenost računa $O(n)$, a
potrebno je izvesti račun za gornji trokut kvadratne matrice širine $n$. Na
kraju složenost računa normaliziranog prosjeka iznosi $O(n * s)$ gdje je $s$
veličina susjedstva. Naposlijetku algoritam \ref{algo:korisnik-korisnik} daje
složenost:
\begin{equation}
\label{eq:slozenostKorisnik}
	O(
		\frac{n \ast (n-1)}{2} + 
		\frac{n^3}{2} + 
		(n \ast s)
	) = O(n^3)
\end{equation}

Ocjena \ref{eq:slozenostKorisnik} ima kvadratnu ovisnost i s povećanjem broja
korisnika dolazi do nemalog povećanja broja operacija za izračun preporuke. 
Valja dodati i da je algoritam \ref{algo:korisnik-korisnik} pojednostavljena
verzija algoitma, pa ni ocjena \ref{eq:slozenostKorisnik} ne može biti uzeta
kao konačna.

\subsubsection{Predmet -- Predmet}
S obzirom na nedostatke prethodne tehnike u performansama, inženjeri poznate
internetske trgovine \emph{Amazon.com} predložili su sličan pristup ali iz druge
perspektive gdje se ne traže sličnosti između korisnika, nego između predmeta
\cite{amazon}. Kao i kod prethodno opisanog pristupa i algoritma
\ref{algo:korisnik-korisnik}, metrika za ocjenu sličnosti između predmeta je
Pearsonov koeficjent korelacije, u ovom slučaju definiran kao:

\begin{equation}
\label{eq:pearsonPredmet}
	R = \frac
			{\sum_{u \epsilon U} 
				\big[
					(r_{u,i} - \overline{r_i}) \ast
					(r_{u,j} - \overline{r_j})
				\big]
			}
			{
				\sqrt{{\sum_{u \epsilon U} (r_{u,i} - \overline{r_i})^2}} \ast 
				\sqrt{{\sum_{u \epsilon U} (r_{u,j} - \overline{r_j})^2}}
			}
\end{equation}

gdje je $U$ skup svih korisnika koji su ocjenili predmete $i$ i $j$, $r_{u,i}$
ocjena korisnika $u$ za predmet $i$, a $\overline{r_i}$ srednja ocjena $i$-tog
predmeta za sve korisnike. Radi jednostavnosti, kod ovog algoritma matrica
ocjena korisnika za predmete normalizira se oduzimanje prosječne ocjene
kojom je svaki korisnik ocjenio predmete. 

Slično kao i kod suradnje na razini Korisnik-korisnik, predviđanje ocjene
korisnika $k$ za predmet $i$ računa se korištenjem težinskog prosjeka:
\begin{equation}
\label{eq:tezinskiProsjek}
	p_{k,i} = 
		\frac
			{\sum_{j \epsilon N} r_{k,j} \ast w_{i,j}}
			{\sum_{j \epsilon N} \|w_{i,j}\|}
\end{equation}
gdje je $N$ susjedstvo predmeta ocjenjenih od strane korisnika $k$ najsličnijih
predmetu $i$.

Jedan od najpoznatijih preporučitelja na svijetu, internetska
trgovina \emph{Amazon.com} koristi patentirani hibridni algoritam baziran na
ovoj tehnici (slike \ref{fig:amazon1} i \ref{fig:amazon2}).
\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/collaborative/amazon.png}
	\caption{Primjer preporuke sustava \glqq Amazon.com\grqq}
	\label{fig:amazon1}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=14.21cm]{images/collaborative/amazon2.png}
	\caption{Primjer preporuke sustava \glqq Amazon.com\grqq}
	\label{fig:amazon2}
\end{figure}

\section{Redukcija dimenzija}
Skup algoritama redukcije dimenzija bazira se na činjenici da je u općem slučaju
baza podataka korisnika i predmeta rijetko popunjena \engl(sparse). Za većinu
korisnika neće biti dostupna većina ocjena, tj. u matrici ocjena korisnika za
predmete, većina elemenata će vjerojatno biti $0$. S druge strane, filriranje
zasnovano na suradnji i suradničko filtriranje u naprednijim slučajevima mogu
biti naivni kada je u pitanju sinonimija između pojmova. 

Neka je dan primjer sustava za prodaju knjiga. Ako je korisnik kupio više
knjiga istog autora, može se pretpostaviti da njegovom profilu odgovara kupljeni
autor. S druge strane, u općem slučaju i ukoliko se isključi mogućnost
slučajnosti, knjiga o tom autoru vjerojatno mu neće biti preporučena jer
suradničko filtriranje neće moći naći vezu između knjige o tom autoru i
kupljenih knjiga, a sadržajno neće biti kompatibilne. Iz tog razloga algoritam
redukcije dimenzija teži u izdvajanje kompleksnih karakteristika u zasebne
podatkovne strukture koje ne ovise niti o korisniku, niti o predmetu.

Matematički gledano, algoritam se bazira na $SVD$ dekompoziciji matrice
korisnika i predmeta \engl{Singular value decomposition}. Rezultat te
dekompozicije je:
\begin{equation}
	\label{eq:svd}
	R = U \ast \sigma \ast V^{\ast}
\end{equation}
gdje je $U$ matrica dimenzija $m X r$, $S$ dimenzija $r X r$, a $V^{\ast}$
dimenzija $r X n$. Matrica $S$ je dijagonalna matrica koja sadrži svojstvene
vrijednosti, a te svojstvene vrijednosti su težine dimenzija koje doprinose
konačnom rezultatu. Ukoliko se vrijednosti sortiraju silazno, može se pokazati
da se većina elemenata nalazi u okolini nule \cite{courseraRC}. To omogućuje da
se odstrane ti elementi pa se matrica $S$ reducira na dimenzije $k X k$, matrica
$U$ na dimenzije $m X k$, a matrica $V^{\ast}$ na dimenzije $k X n$. Konačni
rezultat redukcije jest:
\begin{equation}
	\label{eq:svdred}
	R_k = U_k \ast \sigma_{k} \ast V^{\ast}_{k}
\end{equation}
$R_k$ najbliža $rank-k$ matrica originalne matrice $R$, a $k$ predstavlja broj
dimenzija kompleksnih karakteristika.
Izračun predikcije tada se svodi na skalarni produkt odgovarajućih vektora iz
matrica $U_k$ i $V^{\ast}_{k}$ te svojstvenih vrijednosti iz dijagonalne matrice
$\sigma_{k}$.

Mana ovog algoritma jest skupa i zahtjevna operacija $SVD$ dekompozicije
relativno velikih ulaznih matrica.

\section{Hibridne tehnike}
Hibridne tehnike uglavnom podrazumjevaju kombiniranje više različitih tehnika
filtriranja. Razne okolnosti u kojima rade preporučiteljski sustavi dovode do
različitih primjenjivosti sustava. Primjerice, suradničko filtriranje niti u
teoriji ne može raditi dobro ukoliko nisu zadovoljeni neki preduvjeti, npr.
određeni broj korisnika u sustavu. Zbog toga se kombinacijom više različitih
preporučiteljskih tehnika nastoji proširiti spektar okolnosti u kojima
preporučiteljski sustav može raditi. Nadalje, razlog hibridizacije
preporučitelja može biti, ne samo nemogućnost preporuke, nego traženje
kvalitetnije preporuke u nekim okolnostima. Također, razlog mogu biti i
performanse u različitim okolnostima, pa jedna tehnika može dati bolje rezultate
u nekoj okolini, a neka druga tehnika bolje rezultate u nekoj drugoj okolini.
Neki od poznatijih hibridnih preporučiteljskih tehnika su: \cite{RSHandbook}

\begin{enumerate}
  \item Težinski - ocjena predmeta preporuke računa se iz svih dostupnih
  preporučiteljskih tehnika u sustavu. Najjednostavniji primjer jest linearna
  kombinacija preporuka. Neki sustavi koji koriste ovu tehniku kombiniraju
  preporuke zasnovane na suradnji i preporuke zasnovane na sadržaju uz
  kalibraciju težina u ovisnosti o povratnoj informaciji korisnika.
  \item Izmjenični - kod ove tehnike sustav koristi neki predefinirani kriterij
  za izmjenu tehnike preporuke, primjerice, neka je dan sustav koji inicijalno
  za svakog korisnika koristi preporuku zasnovanu na suradnji. Ako sustav tom
  tehnikom ne može stvoriti preporuku određenog nivoa pouzdanosti, rpebacuje se
  na preporuku zasnovanu na sadržaju.
  \item Miješani - ova tehnika računa preporuke iz više elementarnih
  preporučitelja i prikazuje ih simultano.
  \item Kombinacija obilježja - jedan od načina za spajanje suradnjičkog i
  sadržajnog preporučitelja jest interpretirati informacije suradničkog
  preporučitelja kao dodatne podatke koji čine ulaz sadržajnog preporučitelja.
  \item Kaskada - ova tehnika predstavlja svojevrsnu dvorazinsku preporuku. Prvo
  jedan preporučitelj relativno grubo rangira potencijalne kandidate, a nakon
  toga drugi preporučitelj radi precizniju razdiobu. Tehnika je posebno pogodna
  za one slučajeve kada jedan preporučitelj ne može dovoljno precizno generirati
  predviđanja za preporuke predmeta.
  \item Pojačavanje obilježja - tehnika kod koje je generirano predviđanje ili
  klasifikacija predmeta jednog preporučitelja pripojena slijedećoj
  preporučiteljskoj tehnici u nizu.
  \item Meta razina - izlaz jednog preporučitelja je ulaz drugog preporučitelja.
\end{enumerate}

Konkretne primjene preporučiteljskih sustava u heterogenim okolinama, danas se
svode u velikoj mjeri na različite hibride osnovnih tehnika. Velike industrije
trgovine i zabavnih sadržaja u praksi imaju autorska algoritamska rješenja
hibridnih preporučitelja.
\section{Moguća područja primjene}
Prikazane tehnike preporuke danas se aktivno koriste u gotovo svim sferama
internetskog života. U velikoj mjeri preporučitelji nisu eksplicitni, nego rade
u pozadini, pa se na prvi pogled ne bi moglo reći da je korišten preporučitelj.
Na prvom mjestu svakako jest svakodnevan upotreba internetskih tražilica.
\begin{figure}[!htb]
	\centering
	\includegraphics[width=7cm]{images/google.png}
	\caption{Preporuka internetske tražilice \emph{Google}}
	\label{fig:google}
\end{figure}
Internetske tražilice danas, čak i za neregistrirane korisnike vrlo precizno
mogu prikupiti implicitne podatke i ponuditi personalizirane preporuke.
Pretraživanje internetskih trgovina i \emph{e-commerce} sustava uz današnju
ponudu predmeta i potražnju korisnika praktički je nezamislivo bez nekog oblika
filtra koji će ponuditi korisniku interesantne predmete i navesti ga na druge
bliske predmete. Ovo čini preporučitelje interesnom sferom i za marketing s
obzirom da često upravo o njima ovisi prodaja, a time i zarada.

Internetski servisi za razmjenu i pregledavanje multimedijalnih sadržaja
(\emph{Youtube, Last.fm, Netflix, Pandora}) naveliko koriste preporučitelje kako
bi povećali kvalitetu usluge a time i zadovoljstvo korisnika, pogotovo ako se
radi o plaćenim korisničkim računima. Također, koriste ih često i za pogađanje
ukusa korisnika. Usluga \emph{Last.fm} nudi opciju \glqq Scrobblera \grqq koja u
pozadini prikuplja informacije i stvara liste slušanja bez eksplicitne pomoći
korisnika.

Preporučitelje koriste i \emph{IpTV} usluge \engl{Internet protocol television}
za lakše snalaženje u digitalnim videotekama i pojednostavljenje usluga
multimedije na zahtjev \engl{multimedia - on - demand}.

Društvene mreže i servisi za upoznavanje koriste preporučiteljske sustave za
davanje preporuka na razini korisnik - korisnik. Takve usluge tretiraju objekte
drugih korisnika kao predmete i na sličan način traže $top-N$ listu za aktualnog
korisnika.

Preporučitelje je moguće koristiti i u pametnim prostorima te u \emph{Internet
of things} okolini \cite{Munoz-Organero2010}. U tom kontekstu prostorne i
vremenske karakteristike, te kontekst u kojem se korisnici i predmeti nalaze
potrebno je na poseban način modelirati i uzeti u obzir.

\section{Preporučiteljski sustavi u sveprisutnom računarstvu}
Primjena preporučiteljskih sustava u sveprisutnom računarstvu logična je
posljedica ne samo činjenice da je sveprisutno računarstvo računarstvo kao takvo
pa u njemu postoji interes za preporukom, nego i činjenice da se u njemu
generiraju velike količine podataka pa se preporučiteljski algoritmi mogu
primjeniti kao filtri podataka. O podacima u sveprisutnom računarstvu praktički
je nemoguće govoriti bez konteksta u kojem se nalaze. Taj kontekst može se
definirati kao bilo koja informacija o okolnostima, predmetima ili uvjetima
koje okružuju korisnika, a smatra se relevantnom za interakciju između
korisnika i sveprisutnog računalnog okruženja \cite{RanganathanCampbell}.

Tri najvažnija aspekta kontekseta su \cite{schilit1994context}:
\begin{enumerate}
  \item Gdje se korisnik sustava nalazi
  \item U društvu kojih je drugih korisnika sustava
  \item Koji resursi se nalaze u blizini
\end{enumerate}

Dakle, preporučiteljski sustav, tj. algoritam koji on koristi mora biti
prilagođen barem nekim aspektima konteksta u kojem se sustav nalazi. Najčešće su
to navedeni aspekti uz, ovisno o primjeni, vremenski trenutak u kojem se
zahtjeva preporuka. Također, algoritam mora biti prilagođen filtriranju velike
količine nestrukturiranih i nefiltriranih podataka. Zbog toga te zbog
ograničenih računalnih kapaciteta je na većoj skali nužna optimizacija na
procesnoj i memorijskoj razini. Izazov predstavlja i opisivanje predmeta u
sustavu s obzirom da u sveprisutnom kontekstu predmeti dolaze iz mnogo više
različitih domena, za razliku od prosječnog internetskog dućana. Predmeti
preporuke u sveprisutnom računarstvu najčešće se predmetima nazivaju samo
apstraktno, a može se raditi o preporučenim smjerovima kretanja i sličnim
apstraktnim preporukama. 

Sustav koji implementira preporučitelj za sveprisutnu primjenu mora biti
skalabilan jer će se komponente takvog sustava izvoditi na raznoraznim
računalima, od mogućih mikrokontrolera koji će zahtjevati preporuku do
poslužitelja koji će preporuku, tj. predikciju i izračunati. Osim toga, jedna od
osnovnih odrednica sveprisutnog računarstva je i karakteristika razmjernog
rasta.

Primjer preporučiteljskog sustava koji se djelomično nalazi u sveprisutnom
računarstvu jest algoritam koji koristi \emph{Foursquare}. \emph{Foursquare} je
servis koji preporučuje lokale na temelju preferencija korisnika, njegovih
ocjena sličnih lokacija te ocjena njegovih najbližih prijatelja i stručnjaka
koje prati \cite{FoursquareAbout}. Kod ovog preporučitelja vidljivi su svi
navedeni aspekti konteksta jer je preporučiteljskom algoritmu bitno gdje se
korisnik nalazi, u čijem je društvu te koji su resursi fizički u blizini.
Vremenska komponenta nije prisutna kod ovog preporučitelja.

%-------------------------------------------------------------------------------
%  CHAPTER: Izgrađeni model preporučiteljskog sustava
%-------------------------------------------------------------------------------
\chapter{Izgrađeni model preporučiteljskog sustava}


\section{Preporučiteljski sustavi s izraženom prostornom i vremenskom
komponentom}

Osnovni problem s kojim se konvencionalni preporučiteljski sustavi susreću (a
time i popularniji radni okviri i biblioteke koji ih implementiraju) jest
u većoj mjeri izostanak podrške za kontekstualizaciju. U kontekstu sveprisutnog
računarstva preporučitelj kao minimalan skup konteksta u kojem se sustav nalazi
treba imati podršku za prostornu i vremensku komponentu. Model takvog
preporučitelja može se prikazati relacijom \ref{eq:DefModel2}
\begin{equation}
\label{eq:DefModel2}
	R \leftarrow U \times I \times C
\end{equation}
gdje je $C$ kontekst preporuke, tj. kontekst u kojem se nalazi sustav. Minimalan
skup sastavnica konteksta tada je:
\begin{equation}
\label{eq:Context}
	C \leftarrow T \times S
\end{equation}
gdje je $T$ vremenska komponenta, a $S$ prostorna komponenta

\section{Prostorna komponenta}

S obzirom na kompleksnost postupka modeliranja prostora, prostorna komponenta
konteksta modelirat će se poednostavljeno, i to kvadratnom mrežom
(slika \ref{fig:StoreGrid}). Iako se na prvi pogled tako čini, to nije
ograničenje jer modeliranje prostora u kojem će korisnici tražiti preporuku
najčešće nije slobodno, tj. korisnik se u takvim prostorima kreće putem koji mu
je dostupan. Primjer je dućan u kojem se korisnik može kretati između polica, a
očito je i razumno da se ne može kretati \emph{preko} polica.

\begin{figure}[H]
	\centering
	\includegraphics[width=7cm]{images/grid.png}
	\caption{Tlocrt prostora modeliran kvadratnom mrežom}
	\label{fig:StoreGrid}
\end{figure}

%TODO: ružno napisano, refactor
Dostupne puteve za korisnika može se čuvati u npr. riječnicima
\engl{Dictionary}, tj. parovima $kljuc \rightarrow vrijednost$ gdje je $kljuc$
neko polje kvadratne mreže a $vrijednost$ lista svih \emph{susjednih} polja do
kojih je moguće doći iz polja $kljuc$. Minorna mana ovog pristupa jest
dvostruko spremanje putova jer ako se iz polja $p_1$ može doći u polje $p_2$,
onda se iz polja $p_2$ može doći u polje $p_1$. Dvostruko spremanje može se
izbjeći nauštrb vremenu pretraživanja dvostrukih putanja, a za relativno malu
memorijsku uštedu, čak i kod modeliranja vrlo velikih prostora.

Ako se kvadratnu mrežu i dostupne putove kretanja prikaže kao neusmjereni
težinski graf, onda se taj prostor može predstaviti \emph{matricom
susjedstva}, a kako je takva matrica simetrična, spremati se može samo npr.
gornja trokutasta matrica, čime se postiže svojevrsna rijetka popunjenost
matrice \engl{Sparse Matrix}.
Prednost predstavljanja mreže i prostora grafom jest i postojanje nebrojeno
mnogo pouzdanih i efikasnih algoritama za traženje najkraćeg puta između dva
vrha, odnosno dva polja. Neki od njih su npr. \emph{Dijkstrin algoritam},
\emph{Bellman-Ford algoriam} ili \emph{A$\ast$ algoritam}.

Kvadratna mreža ne mora se nužno prevoditi u graf. U tom slučaju fizička
udaljenost između dva polja može se modelirati \emph{Manhattanskom udaljenosti}
(slika \ref{fig:ManhattanDistance}). Radi se o vrsti udaljenosti koja od
standardne Euklidske udaljenosti odudara po činjenici da je udaljenost dviju
točaka suma apsolutnih razlika njihovih Kartezijevih koordinata.

 \begin{figure}[H]
	\centering
	\includegraphics[width=7cm]{images/Manhattan_distance.png}
	\caption{Ilustracija Manhattanske udaljenosti}
	\label{fig:ManhattanDistance}
\end{figure}

\section{Vremenska komponenta}
Vremenska komponenta koja se uzima u obzir u modelu preporučitelja također je
komponenta konteksta u kojem se nalazi korisnik. S obzirom na ponavljajuće
navike korisnika i prirodno uklapanje, ta komponenta modelirat će se funkcijom
koja preslikava vrijeme na potrebu korisnika za nekim predmetom:
\begin{equation}
	\label{eq:time}
	f: vrijeme \rightarrow predikcija
\end{equation}
Domena funkcije jest vrijeme, a period u teoriji može biti proizvoljan. Dakle,
svaka funkcija prikazivat će želju ili potrebu korisnika za nekim predmetom u
periodu konzistentnom za sve predmete u sustavu. Rezultat funkcije jest
predikcija u intervalu $\big[ 0, 1 \big]$

Jedna takva funkcija može biti primjerice tzv. \emph{Gaussova krivulja}
(slika \ref{fig:Gauss1}). Ona je pogodna zbog činjenice da prosječan korisnik
prosječnu akciju u kojoj će tražiti preporuku u principu traži u jednom kraćem
vremenskom intervalu. Drugim riječima, pojedini predmeti preporuke za nekog
korisnika u vremenski svjesnom preporučiteljskom sustavu bit će zanimljivi samo
jedan kraći interval.
\begin{equation}
	\label{eq:BellFunc}
	f(x;a,b,c) = \frac
	{
		1
	}
	{
		1 + \mid\frac{x - c}{a}\mid^{2b}
	}
\end{equation}
gdje je $x$ varijabla, a $a$, $b$ i $c$ parametri kojima se regulira oblik
krivulje:
\begin{itemize}
  \item $a$ - širina vrha
  \item $b$ - nagib porasta i pada, oblik vrha
  \item $c$ - pomak na $x$ osi
\end{itemize}

\begin{figure}[H]
	\centering
	\includegraphics[width=12cm]{images/zvonolika1matlab.png}
	\caption{Preferencija korisnika za predmet na dnevnoj skali}
	\label{fig:Gauss1}
\end{figure}

S druge strane, skala ne mora biti dnevna, može biti i tjedna te se funkciju
može zadati po dijelovima. Primjer jedne takve funkcije nalazi se na slici
\ref{fig:Gauss2}.

\begin{figure}[H]
	\centering
	\includegraphics[width=14.21cm]{images/neprigusenocropped.png}
	\caption{Preferencija korisnika za predmet na dnevnoj skali}
	\label{fig:Gauss2}
\end{figure}

S obzirom na matematičku analizu koja stoji iza računa za pronalazak funkcijete
kompleksnost i težinu izračuna, one se mogu zadati i diskretno, npr. kroz vektor
uzoraka funkcije. Ta diskretna funkcija može se koristiti kao takva ili se može
procesom interpolacije naći njezin eksplicitni zapis. Pogodne metode
interpolacije mogu npr. biti interpolacija polinomom višeg stupnja ili
interpolacija splajnovima \engl{Spline}.

%TODO: refactor
Vremenska komponenta omogućava i praćenje obrazaca ponašanja korisnika, pa time
i predviđanje ponavljanja ponašanja \engl{Recurring}. Također, vremenska
komponenta podrazumjeva i tzv. \emph{efekt blijeđenja} \engl{Fade-out effect}.
Ako korisnik kod kojeg je uočen neki obrazac akcija prestane provoditi tu
akciju, preporučitelj će prestati primati pobudu za održavanje te akcije.
Međutim, neće je odmah zanemariti nego će se vremenska komponenta, tj. funkcija
koja opisuje tu komponentu, lagano gušiti nekom drugom funkcijom, primjerice
recipročnom eksponencijalnom funkcijom:

\begin{equation}
	\label{eq:RecipExp}
	g(x) = e^{-x}
\end{equation}

Tada će ukupan rezultat vremenske komponente konteksta biti:

\begin{equation}
	\label{eq:Gusenje}
	T \leftarrow f(x) \ast g(x)
\end{equation}

gdje je $f(x)$ funkcija koja opisuje vremensku komponentu konteksta nekog
korisnika za neki predmet, a $g(x)$ funkcija koja guši tu komponentu.
primjer. 

Na slici \ref{fig:GaussPriguseno} vidljiv je primjer \emph{efekta
blijeđenja} na tipično periodičko ponašanje korisnika. Prema formuli
\ref{eq:Gusenje} vrijedi:

\begin{equation}
	\label{eq:BellFunc}
	f(x) = \frac
	{
		1
	}
	{
		1 + \mid\frac{x - 2*k}{0.23}\mid^{5}
	}
	+ 2 \ast k + 1
\end{equation}
gdje je $k \in \{ 0, 1, 2, 3, 4, 5, 6, 7 \}$

\begin{equation}
	\label{eq:Prigusnica}
	g(x)=e^{-0.18 * x}
\end{equation}

Ovdje također postoji mogućnost da se funkcija $g(x)$ zada diskretno, tj. po
uzorcima.

\begin{figure}[H]
	\centering
	\includegraphics[width=14.21cm]{images/prigusenocropped.png}
	\caption{Preferencija korisnika za predmet na dnevnoj skali}
	\label{fig:GaussPriguseno}
\end{figure}

Kod naprednijih modeliranja vremenske komponente, te kod kompleksnijih prilika
ponašanja korisnika, vremensku komponentu teoretski je moguće simulirati
neuronskom mrežom. Mana ovog postupka svakako bi bilo potrebno vrijeme za
treniranje mreže navikama korisnika u vremenskom kontekstu.

\section{Modeliranje korisnika}
Korisnika se u sustavu modelira korisničkim profilom. Takav profil sadrži
elementarne podatke o korisniku:
\begin{itemize}
  \item Jedinstveni identifikator korisnika u sustavu
  \item Ime i prezime korisnika
  \item Vektor preferencija korisnika
\end{itemize}

Vektor preferencija korisnika predstavlja preferencije korisnika za
predefinirane karakteristike. Vektor kao takav može se predstaviti fizičkim
vektorom ili riječnikom gdje je ključ naziv karakteristike a vrijednost mjera
preferencije. Potonji pristup razmjerno je bolji jer minimizira mogućnost krivog
korištenja vektora preferencija.
Kroz rad sustava profil korisnika se dopunjuje na temelju povratnih informacija
korisnika sustava prema preporučitelju. Primjerice, moguće je detektirati
interes korisnika za nekim predmetom pa na takvu vrstu pobude reagirati
pojačavanjem karakteristika u profilu korisnika koje odgovaraju tom predmetu.
Moguće je i pojačavati karakteristike na više različitih načina u ovisnosti o
jačini pobude.
Ovakva vrsta korisničkog profila donekle riješava problem hladnog početka
\engl{Cold start}, jer se može pretpostaviti da su u inicijalnom trenutku
vektori preferencija dostupni u datotekama. Zbog toga će sigurno biti moguće
izvesti sadržajno temeljenu preporuku, dok će do suradničke preporuke moći doći
tek nakon ponovnog treniranja algoritma.

\section{Modeliranje predmeta}

Model predmeta analogno je sličan modelu korisnika. Svaki objekt tipa predmet
sadrži elementarne podatke o predmetu:
\begin{itemize}
  \item Jedinstveni identifikator predmeta u sustavu
  \item Naziv predmeta
  \item Identifikator (oznaka) lokacije predmeta u prostoru
  \item Vektor karakteristika predmeta
\end{itemize}

Vektor karakteristika predmeta posjeduje sadržajni opis predmeta. U vektoru se
na unaprijed dogovorenim indeksima nalaze brojčane mjere primjenjivosti
karakteristike na predmet. U modelu se može koristiti i binarna primjenjivost
koja prikazuje da je neka karakteristika primjenjiva, odnosno nije primjenjiva
na predmet. Alternativno, vektor karakteristika može se prikazati riječnikom,
gdje je ključ u riječniku naziv karakteristike, a vrijednost mjera
primjenjivosti karakteristike na predmet. 
Prilikom unosa predmeta u sustav, vektor karakteristika potrebno je
normalizirati dijeljenjem svakog elementa vektora drugim korijenom zbroja svih
vrijednosti vektora:
\begin{equation}
	\label{eq:norm}
	w_i = \frac
	{
		w_i
	}
	{
		\sqrt{\sum_{j=0}^N w_j}
	}
\end{equation}
gdje je $N$ duljina vektora karakteristika.
\section{Izgrađeni model}

Izgrađeni model preporučiteljskog sustava kombinira mogućnosti svih navedenih
algoritama za filtriranje. Zbog mogućnosti filtriranja po vremenu i prostoru,
može se reći da je algoritam svjestan konteksta te je kao takav primjenjiv u
sveprisutnoj okolini. Algoritam se sastoji od nekoliko koraka:
\begin{enumerate}
  \item Faza prostornog filtra
  \item Faza vremenskog filtra
  \item Opcionalna faza odluke u kojoj, ukoliko nema dovoljno predmeta na listi
  preporuke, algoritam može početi od prvog koraka ali sa spuštenim kriterijima
  \item Faza filtriranja na suradničkoj ili sadržajnoj razini
  \item Faza prezentacije rezultata
\end{enumerate}

Algoritam započinje filtriranjem po prostoru. Sve što je trenutno u okolini
korisnika manje od nekog graničnog radiusa uzima se u obzir, a ostalo se
implicitno odbacuje jer jer rezultat preporuke $0$. Ovaj filtar se prvi izvodi
jer u prostornom kontekstu nema smisla filtrirati prema drugim kriterijima, ako
se predmetu fizički ne može pristupiti. Također, filtar je koristan jer u
početku eliminira velik broj nedostupnih predmeta te tako smanjuje opseg
izračuna. Algoritam prema kojem se filtrira jest neki od poznatijih algoritama
za pronalazak najkraćeg puta ukoliko je prostor na vrhu apstrakcije modeliran
grafom, npr. \emph{Dijsktrin algoritam}, \emph{Bellman - Ford algoritam} ili
\emph{A* algoritam}, odnosno algoritam za izračun \emph{Manhattanske
udaljenosti} ukoliko je na vrhu apstrakcije kvadratna mreža.

Vremensko filtriranje izvodi se skaliranjem vremenskog trenutka u trenutku
izvođenja algoritma na interval tjedna. Granulacija do koje se uzima trenutno
vrijeme je sekunda, a relacija za konverziju je:
\begin{equation}
\label{eq:timeconv}
	t = d + \frac{s}{24} + \frac{m}{1440}
\end{equation}
gdje je $t$ vrijeme primjenjivo u sustavu, $d$ redni broj dana u tjednu počevši
od ponedjeljka kao $1$. dana, $s$ trenutni sati od ukupno $24$ sata, a $m$
trenutne minute. Nakon skaliranja, evaluira se funkcija kojom je opisana
preferencija korisnika za neki predmet. Funkcija je takva da joj je rezultat
skaliran na interval $\big[0, 1\big]$. Efekt blijeđenja \engl{Fade out} izvodi
se množenjem opisne funkcije funkcijom gušenja koja je u općem slučaju
recipročna eksponencijalna funckija. Moguće je primjeniti proizvoljnu funkciju
koja najvjernije opisuje individualnu potrebu svakog korisnika.

Nakon sveprisutno kontekstualiziranog filtriranja, slijedi filtriranje zasnovano
na sadržaju ili filtriranje zasnovano na suradnji i relaciji između više
korisnika. Krajnji korisnik kroz konfiguraciju može birati koji filtar će
koristiti, ili može koristiti oba. U trenutku početka rada sustava, teško je
ostvariti veze između korisnika pa je preporučljivije koristiti sadržajni
filtar. Nakon određenog vremena, moguće je prebacivanje na suradnički filtar
koji se u općem slučaju pokazuje kao stabilnije rješenje \cite{RSHandbook}.
Ove vrste filtriranja koriste podatke o preferencijama korisnika,
karakteristikama predmeta i međusobnim sličnostima između korisnika. Skup ocjena
kojima korisnik može ocjeniti predmet je:
\begin{equation}
	\label{eq:ratings}
	R \in \big[0,5\big]
\end{equation}
Opća granulacija ocjene jest $0.5$ iako sustavski nije ograničeno, tj. sustav
će ispravno raditi sa svim granulacijama.

Razvijeni model sustava odgovara na povratne informacije korisnika. Analizom
korisničkih radnji i kretanja dolazi do pobude na koju je odziv sustava
pojačavanje neke od karakteristika u podatkovnim strukturama. Odzivi mogu biti
različiti i ovise o jačini pobude, primjerice, detekcija zastajkivanja korisnika
kraj određenog predmeta nosi manju pobudu na karakteristike tog predmeta od
detekcije kupnje tog istog proizvoda. Zbroj svih odziva stvara privremeni profil
korisnika koji će postati aktivan tek nakon zbrajanja sa stvarnim profilom, tako
da trenutne akcije ne mogu utjecati na predikcije u trenutnoj sesiji korištenja
sustava.

S obzirom na sve komponente sustava, slijedi algoritam za kontekstualiziranu
preporuku u vremenu i prostoru (\ref{algo:TheAlgo1}):

\begin{algorithm}[H]
	\caption{Algoritam kontekstualizirane preporuke u vremenu i prostoru}
	\label{algo:TheAlgo1}
	\begin{algorithmic}[1]
		\STATE{\textbf{Ulaz: 
			Korisnik $u$, 
			Lista Predmeta $i$,
			Prostor $s$,
			Lokacija korisnika $l$,
			Ocjene $r$,
			Korelacije $c$,
			Veličina liste $n$,
			Konfiguracija $k$} }
		\STATE{\textbf{Izlaz: Predikcija $p$, Slijedeća lokacija $l_i$} }
		
		\COMMENT{Prostorni filtar}
		\STATE{$ListaLokacija := ProstorniFilter(s, l);$} 
		\STATE{$sort(ListaLokacija);$}
		\STATE{$NajvecaUdaljenost := ListaLokacija[ListaLokacija.length - 1]$}
		\FOR{($Lokacija l_j \in ListaLokacija$)}
			\FOR{($Predmet p_i \in Lokacija$)}
				\STATE{$PostaviTezinu(p_i, 1 - (p_i.udaljenost) / NajvecaUdaljenost)$}
			\ENDFOR
		\ENDFOR
		
		\COMMENT{Vremenski filtar}
		\STATE{$VremenskaLista := InitLista();$}
		\STATE{$Vrijeme := SkalirajNaTjedan(TrenutnoVrijeme);$}
		\FOR{($Item i_j \in i$)}
			\STATE{$f := EvaluirajFunkciju(u.funkcija(Vrijeme));$}
			\STATE{$VremenskaLista.add((i_j, f));$}
		\ENDFOR
		
		\COMMENT{Podatkovni filtri}
		\STATE{$SuradnickaLista := InitLista();$}
		\STATE{$SadrzajnaLista := InitLista();$}
		
		\IF{$k.FilterType == COLLABORATIVE$}
			\STATE{$SuradnickaLista := SuradnickiFiltar(u,r,c);$}
		\ELSIF{$k.FilterType == CONTENT$}
			\STATE{$SadrzajnaLista := SadrzajnaLista(u,i,r);$}
		\ELSIF{$k.FilterType == BOTH$}
			\STATE{$SuradnickaLista := SuradnickiFiltar(u,r,c);$}
			\STATE{$SadrzajnaLista := SadrzajnaLista(u,i,r);$}
		\ENDIF
	\end{algorithmic}
\end{algorithm}

\begin{algorithm}[H]
	\label{algo:TheAlgo2}
	\begin{algorithmic}[1]
		\setalglineno{27}
		\STATE{
		\begin{multline*}
			Rezultat := LinearnaKombinacija(
			ListaLokacija, 
			VremenskaLista, \\
			SuradnickaLista, 
			SadrzajnaLista).kombiniraj(k);
		\end{multline*}
			
		}
		\setalglineno{28}
		\STATE{$sort(Rezultat);$}
		\setalglineno{29}
		\STATE{$SlijedeciCvor := NadjiDostupan(Rezultat);$}
		\setalglineno{30}
		\RETURN{$(Rezultat, SlijedeciCvor)$}
	\end{algorithmic}
\end{algorithm}

%Novi chapter%
\chapter{Implementacija i ispitivanje modela}
\section{Arhitektura implementacije}

Programsko riješenje opisanog modela preporučiteljskog sustava izvedeno je u
programskom jeziku $Java$ verzije $8$, a sastoji se od više interoperabilnih
modula koje je prema potrebi moguće nadograđivati. Dijagram razreda sustava
vidljiv je na slici \ref{fig:classdiagram}.

Glavnina funkcionalnosti sadržana je u paketu \emph{filter}. Taj paket u prvom
redu sadrži sučelja \emph{SpaceFilter}, \emph{TimeFilter} te \emph{DataFilter}
implementacijom kojih se ostvaruje mogućnost filtriranja po prostoru, vremenu i
generički po podacima respektivno.
Osim sučelja, paket sadržava implementacije prostornog filtera, vremenskog
filtera, suradničkog filtriranja na korisničkoj razini te filtriranja zasnovanog
na sadržaju. Prostorno filtriranje implementirano je upotrebom standardnog
Dijkstrinog algoritma za pronalaženje najkraćeg puta u grafu. Vremensko
filtriranje izvedeno je evaluacijom funkcije vremena u trenutku traženja
preporuke. Konačni algoritam implementiran je u razredu \emph{TheAlgorithm}, a
kao takav je hibrid filtriranja po prostoru, vremenu i podacima.

U paketu \emph{data} nalaze se razredi koji enkapsuliraju podatke koje koriste
algoritmi za filtriranje. Razred \emph{Correlations} enkapsulira tablicu
Pearsonovih koeficjenata korelacije između svaka dva korisnika u sustavu, dok
razred \emph{Ratings} enkapsulira tablicu ocjena svih korisnika za sve predmete.
Potonji razred posjeduje metode potrebne za sustav pobuda i pojačavanja
obilježja \engl{Reinforcement}. Anotacija \engl{Annotation} \emph{Link} označava
razrede \emph{ItemBeaconLink}, \emph{ItemPredictionLink} i
\emph{UserCorrelationLink}. Navedeni razredi su jednostavni nositelji podataka
između preporučiteljskih algoritama i klijentskog koda. Spremnici podataka
također su i razredi \emph{Matrix} i \emph{Vector} u paketu \emph{commons} koji
modeliraju proizvoljnu matricu, odnosno vektor.

Paket \emph{functions} sadrži sučelja za funkcije koje se koriste u vremenskom
filtru. Sučelje \emph{Function} predstavlja osnovu za implementaciju funkcije.
Naslijeđuju ga sučelja \emph{DiscreteFunction} i sučelje \emph{Continuous
function} koja je potrebno implementirati da bi se ostvarila diskretna, odnosno
kontinuirana funkcija pogodna za korištenje u vremenskom filtru. Također, paket
sadrži konkretnu implementaciju Gaussove zvonolike funkcije konfigurabilne
pomoću parametara $a$, $b$ i $c$ (\ref{eq:BellFunc}).

Model grafa koji opisuje prostor nalazi se u paketu \emph{space}. Graf je
modeliran kroz vrhove (razred \emph{Node}) koji sadrže mape oblika
$vrh \rightarrow udaljenost$ i ostale podatke nužne za ostvarivanje grafa.
Razred \emph{Graph} sadrži listu svih vrhova u grafu te metodu za učitavanje
grafa iz \emph{CSV} datoteke u kojoj je pohranjena matrica susjedstava. Sučelje
\emph{SPAlgorithm} modelira algoritam za traženje najkraćeg puta, a konkretna
implementacija jednog takvog algoritma (Dijkstrinog) nalazi se u razredu
\emph{Dijkstra}.

Korisnici i predmeti modelirani su kroz razrede \emph{User} odnosno \emph{Item}
paketa \emph{model}, a sadržavaju podatke i metapodatke korisnicima i predmetima
koji su nužni za ispravan rad sustava. Za korisnika je to npr. vremenska mapa u
kojoj su pohranjeni parovi ključeva i vrijednosti u obliku
$itemId \rightarrow function$, gdje je $itemId$ jedinstveni identifikator
predmeta, a $function$ funkcija kojom je opisana vremenska preferencija
korisnika za predmetom s identifikatorom $itemId$. Za predmet su to jedinstveni
identifikator, identifikator oznake te mapa karakteristika u obliku
$karakteristika \rightarrow preferencija$, gdje je $karakteristika$ naziv, tj.
identifikator karakteristike, a $preferencija$ brojčana mjera preferencije.
Razred također zadržava statični skup imena svih karakteristika u sustavu.
Paket \emph{model} također sadržava pomoćne razrede \emph{ItemBuilder} i
\emph{UserBuilder} koji korištenjem oblikovnog obrasca \emph{Graditelj} stvaraju
nove objekte tipa \emph{Item} odnosno \emph{User}.
 
Analiza dnevničkih zapisa proizašlih s mobilnog uređaja vrši se kroz razred
\emph{RecordAnalyzer} i metodu \emph{analyze}. Pomoćne strukture za analizu
nalaze se u paketu \emph{io}, a služe za modeliranje zapisa s mobilnog uređaja,
konkretno, trodimenzionalne točke, vremenske oznake te samog zapisa. Razred
\emph{FileInput} s metodom \emph{parseFile} vrši ulaznu obradu dnevničkih
zapisa (tzv. \emph{parsiranje}).

\begin{figure}[H]
	\centering
	\includegraphics[width=12cm]{images/diagramland.png}
	\caption{Dijagram razreda implementiranog preporučitelja}
	\label{fig:classdiagram}
\end{figure}

\section{Ispitni scenarij}
Osmišljavanje ispitnog scenarija pokazalo se natprosječno zahtjevnim radi
pokušaja da takav scenarij obuhvati i ispita sve segmente kontekstualno svjesnog
preporučitelja. S druge strane, takav scenarij je morao biti realno
ostvariv, u smislu da ne bude sintetički osmišljen nego da u realnom
svijetu postoji takva situacija u kojoj će se osmišljeni preporučiteljski
model moći implementirati i koristiti. Na kraju je odabrana prosječna
svakodnevna aktivnost većine potencijalnih korisnika ovakvog sustava, a to je
odlazak u kupovinu.

Ispitni scenarij podrazumjeva generički srednje velik dućan u kojem se
može naći mješovita roba, dakle, i prehrana i neprehrana. Radi jednostavnosti, a
bez značajnijeg utjecaja na krajnji ishod, tlocrt dućana modeliran je mrežastom
strukturom prikazanom na slici \ref{fig:StoreGrid}. U dućanu se na svakom mjestu
mogu nalaziti radio oznake \engl{beacon} kojima mogu biti obilježeni:
\begin{itemize}
  \item Neka lokacija u dućanu, npr. red polica
  \item Skupina proizvoda
  \item Konkretan proizvod
\end{itemize}
Ovdje se nameće pitanje je li potrebno radio oznakama obilježiti sve
potencijalne predmete preporuke. Sa strane sustava, podrazumjeva se
posjedovanje točnih lokacija svake radio oznake, a poznavanjem točnih lokacija
te poznavanjem rasporeda u dućanu, interpolacijom se može aproksimirati lokacija
korisnika u trenutcima kada je on između radio oznaka. Svakoj radio oznaci
pridodani su i neki metapodaci od kojih je najvažniji jedinstveni identifikator
u sustavu.

%TODO: beacon opis
Svaka radio oznaka ima određeni domet signala kojim razašilje \engl{broadcast}
svoj jedinstveni identifikator. Kada se mobilni uređaj nađe u dometu signala, on
prima taj jedinstveni identifikator te može utvrditi \emph{RSS} \engl{Received
signal strength}. 

\begin{figure}[!htb]
	\centering
	\includegraphics[width=9cm]{images/gridbeacons1cell.png}
	\caption{Grafički prikaz radio oznake i mobilnog telefona}
	\label{fig:RssOneCell}
\end{figure}

Slika \ref{fig:RssOneCell} prikazuje slučaj kada je mobilni
uređaj u dometu jedne radio oznake. U tom slučaju može se smatrati da je
korisnik zainteresiran za ono što radio oznaka obilježava. S druge strane,
ako se korisnik nađe u dometu dva ili više radio oznaka (slika
\ref{fig:RssTwoCells}), onda se jednostavno uzima signal one radio oznake čiji
je \emph{RSS} u tom trenutku jači. Naime, \emph{RSS} opada s udaljenošću pa se s
pravom može smatrati da jači \emph{RSS} nužno povlači veću fizičku blizinu
korisnika u odnosu na pripadajuću radio oznaku, tj. ono što ta radio oznaka
obilježava.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=9cm]{images/gridbeacons2cells.png}
	\caption{Grafički prikaz višestrukog prijama signala s radio oznaka}
	\label{fig:RssTwoCells}
\end{figure}

Također, uzima se u obzir i vrijeme zadržavanja korisnika u blizini radio
oznake. Ukoliko je korisnik proveo manje vremena od neke empirijski određene
vremenske granice $t_min$, onda se može smatrati da korisnik nije iskazao
interes za predmet koji radio oznaka obilježava.
U obzir valja uzeti i orjentaciju korisnika. Nerijetko je moguće da korisnik
bude u dometu signala radio oznake, a fizički nije usmjeren prema predmetu koji
ona označava. Korištenjem magnetometra na pametnom uređaju i poznavanjem
razmještaja radio oznaka u prostoru, može se jednostavno utvrditi je li korisnik
iskazao interes za obilježeni predmet ili je okrenut od njega.

Izvor podataka je dobro enkapsuliran pa se može reći da mora implementirati
sučelje s određenom opremom, a ta oprema je:
\begin{itemize}
  \item Komunikacijski radio, npr. \emph{WLAN} \engl{Wireless LAN} -- koristi
  se za svu komunikaciju sa poslužiteljima po pitanju dohvaćanja metapodataka o
  radio oznakama, traženje preporuke itd.
  \item Magnetometar -- koristi se utvrđivanje je li korisnik okrenut prema
  radio oznaci ili od nje. % 
  \item Akcelerometar -- koristi se za utvrđivanje gibanja korisnika. Ako je
  korisnik u pokretu, zanemaruju se podaci sa ulaza za očitavanje radio oznaka
  \item Bluetooth -- koristi se za komunikaciju s radio oznakama
\end{itemize}

Takav izvor u praksi može biti bilo koji moderniji mobilni telefon ili tablet.

\section{Simulacija primjene}
U praktičnom smislu, ispitni scenarij modeliran je radio oznakom i prolaskom
korisnika s mobilnim telefonom. Korisnik hoda normalnim hodom prosječne brzine,
a mobilni telefon drži u ruci koja slobodno visi i giba se u skladu s koracima.
Radio oznaka razašilje jedinstveni identifikator frekvencijom od $1 Hz$, a
mobilni telefon bilježi podatke frekvencijom od $5 Hz$. Različite razine
povratne informacije preporučitelju o akcijama korisnika simulirane su
različitim ponašanjem u ispitnom scenariju, a vidljive su u tablici
\ref{tbl:podscenariji}

\begin{table}[!htb]
	\caption{Ispitni podscenariji}
	\label{tbl:podscenariji}
	\centering
	\begin{tabular}{|c|c|c|} \hline		
		Dataset & Način zaustavljanja & Korištenje mobitela\\ \hline
		1 & Ne postoji & Ne\\
		2 & Usporavanje & Ne\\
		3 & Zastajkivanje & Ne\\
		4 & Zastajkivanje & Kraće podizanje\\
		5 & Zastajkivanje & Dulje podizanje\\
		6 & Zaustavljanje & Ne\\
		7 & Zaustavljanje & Kraće podizanje\\
		8 & Zaustavljanje & Dulje podizanje\\ \hline
	\end{tabular}
\end{table}

Tablica \ref{tbl:reinforcement} prikazuje konkretne iznose odgovora na različite
pobude od strane korisnika na sustav.

\begin{table}[!htb]
	\caption{Reakcije na interakciju korisnika i predmeta}
	\label{tbl:reinforcement}
	\centering
	\begin{tabular}{|c|c|} \hline		
		Način zaustavljanja & Pojačanje\\ \hline
		Ne postoji & 0\\
		Usporavanje & 0.025\\
		Zastajkivanje & 0.05\\
		Zaustavljanje & 0.1\\ \hline
	\end{tabular}
\end{table}

%Kako se konkretno računa zaustavljanje, usporavanje zastajkivanje itd.

\subsection{Ulazi}
Ulazi u sustav ugrubo se mogu podijeliti na ulaze potrebne za postavljanje
sustava i ulaze na koje sustav reagira preporukom. Ulazi potrebni za
postavljanje su tlocrt, tj. prostorni opis okoline, podaci o ocjenama korisnika
sustava za predmete, predmeti sustava sa vektorima svojih karakteristika te
podaci o vezama između radio oznaka i predmeta. Uz navedene podatke, ulaz u
sustav je i jedinstveni identifikator korisnika za kojeg se traži preporuka. Taj
identifikator jest jednostavan podatak cjelobrojnog tipa pa neće biti detaljnije
opisivan. Također, ulaz u sustav je i cijeli broj $N$ kojim se specificira
koliko se najboljih predmeta traži za korisnika.

\subsubsection{Prostorni opis okoline}
Za potrebe testiranja koristi se jednostavni generirani tlocrt prikazan slikom
\ref{fig:layout}. Razlog relativno jednostavnom tlocrtu jest kombinatorna
eksplozija kojoj su veći prostori podložni. Tlocrt se učitava iz \emph{CSV}
datoteke \engl{Comma separated values}, a u toj datoteci zapisana je matrica
susjedstava grafa (\ref{eq:adjacencyMatrix}) koji odgovara tlocrtu. Zbog
jednostavnosti, praktično je tlocrt prikazati grafom zbog velikog broja
dostupnih i provjerenih algoritama za izračun udaljenosti između čvorova

\begin{figure}[!htb]
	\centering
	\includegraphics[width=5cm]{images/3x3grid.png}
	\caption{Jednostavan ispitni tlocrt}
	\label{fig:layout}
\end{figure}

\begin{equation}
	\label{eq:adjacencyMatrix}
	M = 
	\begin{bmatrix}
		0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
		0 & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 0\\
		0 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0\\
		1 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
		0 & 1 & 1 & 0 & 0 & 1 & 0 & 1 & 0\\
		0 & 1 & 1 & 0 & 1 & 0 & 0 & 0 & 0\\
		0 & 0 & 0 & 1 & 0 & 0 & 0 & 1 & 0\\
		0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 1\\
		0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
	\end{bmatrix}
\end{equation}

U datoteci u kojoj je tlocrt zapisan, elementi stupaca matrice odvojeni su
znakom točka - zarez \engl{Semicolon}, a elementi redaka znakom novog retka.
Datoteka se procesira na početku rada sustava, a po potrebi svaki put kada se
dogodi promjena rasporeda u prostoru. U tom slučaju, pretpostavlja se da će u
datoteci biti zapisan novi tlocrt prostora.

\subsubsection{Veza između radio oznaka i predmeta}
Veza između radio oznaka i predmeta razmjerno je jednostavna. Također se učitava
iz \emph{CSV} datoteke, a format joj je:

\begin{equation}
	\centering
	beaconId;itemId
\end{equation}

S obzirom da izmjena radio oznake za neki predmet nije česta radnja, datoteka se
procesira jedanput na početku rada sustava. U slučaju promjena, nove podatke
moguće je unijeti dinamički u sustav.

\subsubsection{Podaci o predmetima}
Podaci o predmetima učitavaju se iz \emph{CSV} datoteke. Opći izgled retka
datoteke je:

\begin{equation}
	\centering
	itemId;itemName;locationId\#CharName1;CharName2 \ldots
\end{equation}

Prvo se čita prvi redak datoteke iz kojeg se nakon razdvajanja učitanog retka po
znaku $\#$ prebrojavaju i učitavaju imena karakteristika kojima će se opisivati
predmeti. Karakteristika u sustavu može biti neograničeno mnogo. Nakon toga
slijedi slijedno čitanje datoteke, redak po redak. Svaki redak započinje
cijelim brojem koji je jedinstveni identifikator predmeta u sustavu. Nakon
njega, odvojen točka-zarezom slijedi naziv predmeta te cijeli broj koji je
jedinstveni identifikator lokacije, tj. ćelije, u sustavu. Nakon
znaka $\#$ slijedi niz sastavljen od $0$ ili $1$ odvojen znakom točka-zarez.
Znak $0$ označava da ta karakteristika nije prisutna u predmetu kojem pripada
redak, a znak $1$ da je karakteristika prisutna, tj. primjenjiva na predmet.

Nakon inicijalnog čitanja datoteke, nove predmete u sustav moguće je unijeti
dinamički. Primjer ove datoteke nalazi se u dodatku.

\subsubsection{Matrica ocjena korisnika}
Matrica ocjena korisnika također razlikuje prvi redak od ostalih. 
Oblik prvog retka datoteke je:
\begin{equation}
	\centering
	;itemId\#itemName;itemId\#itemName
\end{equation}
gdje predmeta može biti nedefinirano mnogo. Općeniti izgled ostalih redaka je:
\begin{equation}
	\centering
	userId;ratingForItem1;ratingForItem2 \ldots
\end{equation}
gdje je $userId$ jedinstveni identifikator korisnika u sustavu, a
$ratingForItem$ ocjena korisnika za predmet kojem odgovara stupac u kojem se ta
ocjena nalazi. Ocjene su predstavljene skupom:
\begin{equation}
	\centering
	R \in \big[ 0.5, 5.0 \big]
\end{equation}
Općenito, granulacija dodjeljivanja ocjena jest $0.5$ iako to nije kriterij za
stabilan rad sustava. Ukoliko ocjena korisnika za neki predmet ne postoji, pri
obradi retka, na to mjesto umeće se numerička oznaka $-100.0$ koja se naravno
ne koristi kao ocjena nego kao oznaka neodstatka ocjene. Primjer ove datoteke
može se naći u dodatku

\subsubsection{Dnevnički zapisi mobilnog uređaja}
Krajnji ulaz u sustav, bez ikakve apstrakcije, su dnevnički zapisi \engl{Log} s
pametnog uređaja. U njih uređaj zapisuje:
\begin{itemize}
  \item Vremensku oznaku
  \item Jedinstveni identifikator radio oznake
  \item \emph{RSS} \engl{Received signal strength}
  \item Podatke s mjerača ubrzanja \engl{Accelerometer}
  \item Podatke s magnetometra \engl{Magnetometer}
\end{itemize}
Dnevnički zapisi se pišu i čitaju u, odnosno iz obične tekstualne datoteke u
predefiniranom formatu:
\begin{equation}
	\centering
	timestamp;beaconId\$rss\#accelerometer\#magnetometer\char`\\n
\end{equation}
gdje je $\char`\\n$ oznaka za novu liniju \engl{Line feed}
Podaci $beaconId$ i $rss$ su, tipski gledano, jednostavni, a $timestamp$,
$accelerometer$ i $magnetometer$ složeni.

\begin{itemize}
  \item Vremenska oznaka -- $sat:minuta:sekunda.stotinka$
  \item Mjerač ubrzanja -- $x;y;z$ - mjeri ubrzanje sile na tri fizičke osi
  uređaja u $m/s^2$, uključujući ubrzanje sile teže \cite{AndroidSensors}. Točan
  položaj osi, tj. mobilnog uređaja u koordinatnom sustavu prikazan je na slici
  \ref{fig:coordinates}
  \item Magnetometar -- $x;y;z$ - mjeri ambijentalno geomagnetsko polje na tri
  fizičke osi uređaja u $\mu T$ \cite{AndroidSensors}.
\end{itemize}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=5cm]{images/coordinates.png}
	\caption{Mobilni uređaj u trodimenzionalnom koordinatnom sustavu}
	\label{fig:coordinates}
\end{figure}

\subsection{Izlazi}

Izlazi iz sustava su serijalizirani $Java$ interni objekti $ItemPredictionLink$
slijedećeg oblika:
\begin{equation}
	\centering
	ItemPredictionLink\{ 
		itemId=N,
		prediction=P
	\}
\end{equation}
gdje je $itemId$ jedinstveni identifikator predmeta u sustavu, a $prediction$
predikcija ocjene korisnika za kojeg je preporuka zatražena za predmet s
identifikatorom $itemId$. Objekti su smješteni u jednostruko povezanoj listi, a
prethodno su sortirani padajućim redoslijedom prema predikciji. Rezultati rada
sustava kao objekti se ispisuju na standardni izlaz računala \engl{STDOUT}.

\section{Rezultati ispitivanja}
Ispitivanje rada sustava izvedeno je korištenjem $JUnit 4$ knjižnice za
programski jezik $Java$. Ispitana je svaka komponenta preporučiteljskog
algoritma, a rezultati su prikazani u nastavku.  Za testiranje se koristio
korisnik s jedinstvenim identifikatorom $89$.
Zbog jednostavnosti i velike količine potrebnih ispitnih podataka, samo je dio
tablica ocjena i liste predmeta s karakteristikama prikazan u dodatku. Također,
isključivo iz praktičnih razloga nisu prikazani cijeli ispisi sustava na
standardni izlaz nego samo prvih $15$, odnosno $10$

\subsection{Ispitivanje prostornog filtera}
S obzirom na razmjerno jednostavan ispitni tlocrt, rezultati su uglavnom
jednolični jer svakoj ispitnoj lokaciji pripada približno $11$ predmeta. Testni
tlocrt je prikazan na slici \ref{fig:layout}. U nastavku je primjer ispisa
prostornog filtra.

\lstinputlisting[
		language=Java, 
		firstline=1,
		lastline=25, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{tests/space.txt}

\subsection{Ispitivanje vremenskog filtera}
Zbog nemogućnosti za naprednijim modeliranjem ponašanja korisnika funkcijom, pri
ispitivanju vremenskog filtra, korištena je neprigušena Gaussova funkcija
(\ref{eq:BellFunc}) s parametrima nasumično odabranim parametrima iz intervala:
$a \in \big[0.2, 0.25 \big]$, 
$b \in \big[2.2, 2.7 \big]$ i 
$c \in \big[1.8, 2.2 \big]$.
Parametri Gaussove krivulje namjerno su nasumično odabrani kako bi se pokazalo
variranje u preporuci, jer bi suprotnom predikcija za svaki predmet bila bi
identična. Kod ove vrste ispitivanja nemoguće je koristiti ispitne knjižnice
jer ispitni rezultat ovisi o trenutku u kojem je pokrenuto ispitivanje.

\lstinputlisting[
		language=Java,
		firstline=1,
		lastline=10, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{tests/time.txt}

\subsection{Ispitivanje sadržajnog filtera}
Uz tablicu ocjena, korišteni su podaci o preferencijama korisnika. Svaki predmet
je opisan s $10$ karakteristika koje mogu imati vrijednost $0$ ili $1$, tj.
karakteristika nije primjenjiva na predmet, odnosno karakteristika je
primjenjiva na predmet.

\lstinputlisting[
		language=Java, 
		firstline=1,
		lastline=10, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{tests/content.txt}

\subsection{Ispitivanje suradničkog filtera}
Za ispitivanje suradničkog filtera korištena je baza od $25$ korisnika i $100$
predmeta. Tablica ocjena je rijetko popunjena kako bi se simulirala realna
situacija u kojoj korisnici ne mogu ocijeniti svaki predmet u sustavu.
Susjedstvo ispitnog korisnika je $N = 5$, dakle, pri izračunu predikcije koristi
se $5$ najbližih korisnika pronađenih najvećim Perasonovim koeficjentom
korelacije.

\lstinputlisting[
		language=Java, 
		firstline=1,
		lastline=10, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{tests/useruser.txt}

\subsection{Ispitivanje ukupnog algoritma}
Kod ispitivanja konačnog algoritma korištena je kombinacija svih filtara, s time
da je udio svakog od sadržajnog i suradničkog filtera u konačnom rezultatu
$50\%$. U nastavku se nalazi ispis najboljih $10$ predmeta za ispitnog
korisnika.

 \lstinputlisting[
		language=Java, 
		firstline=1,
		lastline=10, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{tests/thealgo.txt}
	
\subsection{Ispitivanje podsustava za pojačavanje obilježja}
Kod ispitivanja podsustava za pojačavanje obilježja, korištena je radio oznaka
kojom je u simulaciji bio označen predmet s jedinstvenim identifikatorom $11$.
Ispitana je detekcija povratne informacije korisnika na temelju jačine signala i
vrijednosti mjerača ubrzanja. Ispitni scenariji opisani su u tablici
\ref{tbl:podscenariji}. Za svaki skup podataka, podaci su nanovo učitani iz
\emph{CSV} datoteka. Radi jednostavnosti, sustav ispisuje samo detektiranu vrstu
pobude i odziv na tu pobudu. Rezultati testiranja vidljivi su u tablici
\ref{tbl:rezultati}.

\begin{table}[H]
	\caption{Rezultati ispitivanja podsustava za pojačavanje obilježja}
	\label{tbl:rezultati}
	\centering
	\begin{tabular}{|c|c|c|c|c|} \hline		
		Skup podataka & Datoteka & Pobuda & Odziv & Stanje nakon odziva\\ \hline
		1 & 1 & Prolazak & 0 & 4.5\\
		 & 2 & Prolazak & 0 & 4.5\\
		 & 3 & Prolazak & 0 & 4.5\\ \hline
		2 & 1 & Usporavanje & 0.025 & 4.525\\
		 & 2 & Zastajkivanje & 0.05 & 4.575\\
		 & 3 & Usporavanje & 0.025 & 4.6\\ \hline
		3 & 1 & Zastajkivanje & 0.05 & 4.55\\
		 & 2 & Zastajkivanje & 0.05 & 4.6\\
		 & 3 & Zastajkivanje & 0.05 & 4.65\\ \hline
		 
		 4 & 1 & Zastajkivanje & 0.05 & 4.55\\
		 & 2 & Zastajkivanje & 0.05 & 4.6\\
		 & 3 & Zastajkivanje & 0.05 & 4.65\\ \hline
		5 & 1 & Zastajkivanje & 0.05 & 4.55\\
		 & 2 & Zastajkivanje & 0.05 & 4.6\\
		 & 3 & Zastajkivanje & 0.05 & 4.65\\ \hline
		6 & 1 & Zaustavljanje & 0.1 & 4.6\\
		 & 2 & Zastajkivanje & 0.05 & 4.65\\
		 & 3 & Zaustavljanje & 0.1 & 4.75\\ \hline
		 
		 7 & 1 & Zaustavljanje & 0.1 & 4.6\\
		 & 2 & Zaustavljanje & 0.1 & 4.7\\
		 & 3 & Zaustavljanje & 0.1 & 4.8\\ \hline
		8 & 1 & Zaustavljanje & 0.1 & 4.6\\
		 & 2 & Zaustavljanje & 0.1 & 4.7\\
		 & 3 & Zaustavljanje & 0.1 & 4.8\\ \hline

	\end{tabular}
\end{table}

\chapter{Zaključak}

Sveprisutno računarstvo, kao treći veliki val u računalnoj eri nepobitno ulazi u
sfere intenzivnog i svakodnevnog korištenja, kako u poslovnom, tako i privatnom
svijeti. Ono kao takvo generira i koristi velike podatkovne skupove zbog same
prirode podataka, a to su najčešće lokacija, vrijeme, atmosferski podaci i sl.
Iz tog razloga, kao i zbog činjenice da će nepobitno nastaviti svoj razvoj,
potrebni su kvalitetni i efikasni algoritmi filtriranja podataka.

S druge strane, preporučiteljski sustavi čiji razvoj traje otprilike koliko i
razvoj sveprisutnog računarstva, danas su se nametnuli kao neizostavni filtri u
svim primjenama gdje postoje sustavi s velikim skupovima podataka, a korisnik od
tog istog sustava zahtjeva ili konkretni podatak ili uslugu. Danas, vjerojatno
niti jedna internetska trgovina nije zamisliva bez kvalitetnog preporučiteljskog
algoritma. U radu je dan pregled bazičnih filtarskih algoritama, a to su
neosobno filtriranje, filtriranje zasnovano na sadržaju, filtriranje zasnovano
na suradnji te metoda redukcije dimenzija. Prikazani su i hibridi tehnika, širok
spektar mogućnosti za upotrebu preporučiteljskih sustava te su analizirani
zahtjevi na preporučitelje u sveprisutnom računarstvu.

Kao metoda preporučivanja u sveprisutnoj okolini osmišljen je kontekstno svjesni
algoritam koji uz kontekstne filtre koristi neke postojeće preporučiteljske
tehnike. Algoritam se sastoji od slijedećih filtara:
\begin{enumerate}
  \item Prostorni filtar za preporučivanje prema udaljenosti u prostoru za
  fizički dostupne predmete
  \item Vremenski filtar za preporučivanje prema vremenskim navikama korisnika
  na periodu od jednog tjedna
  \item Sadržajni filtar za preporučivanje prema karakteristikama kojima je
  opisan svaki predmet u sustavu
  \item Suradnički filtar za preporučivanje prema sličnosti korisnika u sustavu
\end{enumerate}

Uz algoritam, prikazan je u potpunosti i model sustava koji sadrži opisani
hibridni preporučiteljski algoritam. Prikazano je modeliranje korisnika i
predmeta sustava te zahtjevi na modeliranje. Prikazan je i način kombiniranja
rezultata filtara u jedinstvenu predikciju.

Naposlijetku, razvijeni model sustava implementiran je u programskom jeziku
$Java$ te je prikazana arhitektura implementacije. Razvijeni model isproban je
na fiktivnom scenariju dućana uz ispitivanje i ulazne podatke s pametnog
telefona. Osmišljeni su razni scenariji povratne informacije preporučitelju od
strane korisnika u vidu detekcije ponašanja korisnika u odnosu na radio oznakom
označeni predmet te odzivi sustava na takve informacije. U svrhu ispitivanja,
detaljno su prikazani ispitni podaci. Na kraju su prikazani ispitni rezultati.

Rad u svakom slučaju ima prostora za napredak. Na prvom mjestu bi svakako bila
podrobnija ispitivanja u kompleksnijim i realnijim scenarijima. Temeljem tih
ispitnih podataka bolje bi se mogli ugoditi parametri algoritama do čijih se
optimalnih vrijednosti može doći samo empirijski, primjerice omjer korištenja
suradničke i sadržajne predikcije. Interdisciplinarnom suradnjom s područjima
psihologije i ekonomije također bi se mogli poboljšati parametri filtara, u
prvom redu, vremenskog filtra čiji uspješan rad uglavnom ovisi o kvalitetnom
matematičkom opisu navika korisnika. Još jedna mogućnost daljnjeg razvijanja
postoji i u marketingu i komercijalizaciji preporučitelja. U suradnji sa
stvarnim dućanima, preporučitelj bi se mogao prilagoditi realnim i individualnim
potrebama svakog potrošača. Optimizacija algoritama druga je osnovna baza za
napredak projekta. U tom pogledu moguće je osmisliti bolje načine modeliranja
vremena i prostora pa time i filtriranja vremena i prostora. Modeli korisnika i
predmeta također su podložni optimizaciji. Moguće je i ispitivati druge načine
povezivanja filtarskih rezultata u jedinstvenu preporuku.

Budućnost projekta moguća je i van sfere trgovine i marketinga. Prikazani
koncept u potpunosti je moguće primjeniti i u druge sveprisutne aplikacije
kojima je potreban preporučiteljski sustav, primjerice, veliki sajmišni
prostori.

\bibliography{literatura}
\bibliographystyle{fer}

\begin{sazetak}
U ovom radu dan je uvod u sveprisutno računarstvo. Analizirani su temeljni
algoritmi koje koriste preporučiteljski sustavi, te su analizirani zahtjevi na
preporučiteljske sustave korištene u sveprisutnim okruženjima. Osmišljen je
model kontekstno svjesnog preporučiteljskog sustava s posebnim naglaskom na
prostor i vrijeme. Prikazani su mogući načini modeliranja prostora, vremena,
korisnika i predmeta u sustavu, te je prikazan način sinteze filtarskih
algoritama u jedinstvenu predikciju. Na kraju, osmišljeni model je
implementiran i ispitan na osmišljenom ispitnom scenariju u realnim uvjetima.

\kljucnerijeci{sveprisutno računarstvo, preporučiteljski sustavi, kontekst,
svjesnost konteksta, prostor-vrijeme, filtriranje podataka}
\end{sazetak}

\engtitle{Recommender systems in ubiquituous computing}
\begin{abstract}
This thesis shows fundamentals of Ubiquitous computing. Basic algorithms used by
Recommender systems have been analysed, as well as requirements for Recommender
systems used in ubiquitous environments. Context aware recommender system with
special intrest in space and time has been designed. Possible ways of modelling
space, time, user and item have been analyzed and shown. Also, a way of
sinthesys of the filtering algorithms into one unique prediction has been shown.
Finally, designed model has been implemented and tested on made up scenario in
real conditions.

\keywords{ubiquitous computing, recommender systems, context, context
awareness, spacetime, data filtering}
\end{abstract}

\appendix
\chapter{Primjer dnevničke datoteke}
\lstinputlisting[
		language=C, 
		firstline=37,
		lastline=46, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{logs/LogFile_06-06-15_18_27a.txt}
	
\chapter{Datoteka s podacima o predmetima}
\lstinputlisting[
		language=C, 
		firstline=1,
		lastline=15, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{csv/items.csv}

\chapter{Datoteka s matricom ocjena korisnika}
\lstinputlisting[
		language=C, 
		firstline=1,
		lastline=15, 
		numbers=left, 
		breaklines=true, 
		numbersep=5pt,
		numberstyle=\color{mygray}
	]{csv/ratings.csv}
	
\end{document}
